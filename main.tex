% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.
\errorcontextlines=500

\documentclass[12pt]{ociamthesis}  % default square logo 

%\usepackage{geometry}

%\documentclass[a4paper,11pt,oneside]{bo222ok}
%\usepackage[DIV=14,BCOR=2mm,headinclude=true,footinclude=false]{typearea}

\input{preamble}

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)


\title{Relational Semantics \\{ \it \Large for}\\ Quantum Protocols}
\author{Cole Comfort}
\college{New College}  %your college
\degree{Doctor of Philosophy in Computer Science} 
\degreedate{October $\text{6}^{\text{th}}$, 2023}    

%\renewcommand{\submittedtext}{change the default text here if needed}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 





%introduction
%  motivation behind relational interpretations
%basic category theory
%  Monoidal categories and compact closed categories
%    Definitions
%    Strictification
%      string diagrams for strict monoidal categories
%      Proof nets for non strict monoidal categories
%    Process theoretic interpretation
%      Space and time
%    Monoidal theories
%      Finite sets
%  Spans and relations
%     Spans and cospans of finite sets and frobenius algebras
%     Linear relations, affine relations and their monoidal theories
%     Cartesian restriction categories
%     Discrete inverse categories
%       Cartesian completion and Para construction
%     Cartesian bicategories
%Internal categories
%  Monads
%  Internal categories
%  Distributive laws
%    Distributive laws of monoidal categories
%  Bimodules of monads (internal profunctors)
%    Distributive laws of symmetric monoidal categories
%Categorical quantum mechanics
%  Finite dimensional hilbert spaces and their strictification to complex matrices
%  Dagger compact closed structure
%  Isometries, unitary evolution and quantum observables
%  CPM construction and splitting dagger idempotents as measurement
%  Z and X observables
%  Stabilizers as +1 eigenvectors
%  Joint stabilizers and the stabilizer formalism
%  ZX-calculus
%    Phase-free ZX calculus
%       Phase-free ZX-calculus and linear relations
%    Z and X fragments
%       Affine relations
%    Stabilizer ZX-calculus
%      Hint at Symplectic algebra
%  ZH-calculus
%    Hint at ZX& construction
%  Discard construction
%ZX&-calculus
%Graphical symplectic algebra
%Deconstructing things using distributive laws
%Conclusion
% Hint at combining ZX& and stabilizer ZX-calculus to get nonlinear processing

%TODO
%Standardize tensor product for linear relations (tensor, direct sum, addition on objects)
%Give better exposition of the symplectic formalism in the introduction
%  Talk about spekkens toy model more and the divergence between the stabilizer formalism in odd dimensions in the symplectic algebra chapter
%Give examples of error correcting codes and protocols with affine and non-affine classical processing
%Talk about ZX& calculus as being stabilized by nonlinear set of X operators.
%Talk about combining stabilizer codes with classical processing
%L2 function in weil representation of ZXA and stabilizers
%Change words white and grey to inline tikz circles

%give a nontechnical overview at the beginning of each section (for example, string diagrams from a graphical perspective) Put these resumes in special boxes

%Also put axioms in special boxes

%\usepackage{showframe}




\setenumerate{align=left}




\renewcommand\bibname{Bibliography\\
 \textnormal{\small  I have included urls to publicly accessible versions of all cited works wherever possible.}\\
 \vspace*{-.5cm}\textnormal{\small Therefore, as oppposed to the dois, the urls may not the exact versions cited.}}



\begin{document}
\maketitle

%\sloppy

\begin{abstract}
In this thesis we exhibit nondeterministic semantics for fragments of quantum circuits using  categories of spans and relations.  First, we show that the class of circuits generated by Toffoli gates as well as state preparation and postselection in the Z and X basis is characterized in terms of spans of finite sets/matrices over the natural numbers, and give a complete presentation thereof. With this semantics in mind, we discuss the connection to partial and reversible computation. We also exhibit an isomorphism between the prop of affine coisotropic relations over odd prime fields and odd-prime-dimensional mixed stabilizer circuits; we show how this can be constructed by doubling the phase-free ZX-calculus twice, iterating the CPM construction.   We show how this is closely related to previously known semantics for idealized classes of electrical circuits.     Finally, we attempt to give a categorical semantics for proof nets for monoidal the scalable ZX-calculus using profunctors which are a categorification relations.
\end{abstract}


\tableofcontents


\chapter{Introduction}
\label{chap:intro}


The traditional paradigm for quantum computing decomposes a quantum computation into  distinct stages. First, a quantum state is prepared in the lab; then the quantum state is evolved by applying unitary operations; next, the quantum state is measured according to the Born rule.  There are several variations on this paradigm; for example,  one can measure only part of the system and apply classically controlled unitary operations to correct for errors; or in the measurement based approach, one could prepare a quantum state and then evolve the state by performing a series of partial measurements which are conditioned on each other. However, these tradiditional approaches are quite rigid, where the different stages of the process are modelled by different kinds of mathematical objects.  %Moreover, the born rule entails that the measurements depend {\em probabilistically} on the choice state preparation and unitary evolution.

In this thesis, we model quantum computation in the more flexible quantum circuit model, where the state preparation, evolution and measurement all live on similar footing.  More precisely, departing from most treatments of quantum circuits, we regard of these different stages of a quantum computation as subspaces. These subspaces are composed by tracing out the common elements in their intersection.  Two types of subspaces appear in this thesis, namely subsets of finite sets and affine/linear subspaces of vector spaces over finite fields.  We associate the Hilbert space of square-integrable functions to these spaces. The subspaces correspond to the nondeterministic evolution of the system, as opposed to a probabilistic evolution.  That is to say, by regarding these classes of quantum circuits as subspaces, the inputs and outputs are associated to each other with respect to which output is {\em possible} from which input.

In Chapter \ref{chap:background}, we review the mathematical background which is needed to understand this thesis.  In Section \ref{sec:cat}, we give a brief review of relevant notions in category theory.  We first review the theory of monoidal categories and string diagrams in which allows us to regard circuits as abstract mathematical objects.  Next we review categories of spans and relations, which are the mathematical semantics for circuits with nondeterministic evolution.  In Section \ref{sec:cqm}, we review some of the basic results in categorical quantum mechanics which relates monoidal categories and string diagrams to quantum computing. This entails giving an overview of the languages for quantum circuits known as the  ZH and ZX-calculi; as well as reviewing the mathematical machinery needed to model mixed states and measurement within this framework.

In Chapter \ref{chap:zxa} we analyze the class of quantum circuits generated by the Toffoli gate as well as state preparation and post selection in the $Z$ and $X$ basis.  We give a complete presentation for this category and interpret it in terms of spans of finite sets.  We show that this class of circuits has very close to a nondeterministic semantics, except where outcomes can happen multiple times.  By imposing an additional equation, we depart from the interpretation into Hilbert spaces, and obtain a semantics with a proper  nondeterministic semantics in terms of relations between finite sets. We then decompose this presentation into small fragments; composing these small building blocks incrementally via distributive law and pushout.
We exhibit substructural features of these various decompositions and discuss how by allowing only some of the generators, we obtain semantics which are partial, partially invertible and so on; associating classes of generators to different semantic paradigms of computation.


In Chapter \ref{chap:stab}  we analyze the structure of odd-prime dimensional/quopit stabilizer circuits.
We expose the relational interpretation of these circuits, by adding generators at each point, obtaining a richer semantics.  We first recall that the phase-free fragment of the qupit ZX-calculus modulo scalars, for prime qudit dimension $p$ is isomorphic to the prop of linear relations over $\F_p$: ie where the maps are linear subspaces over $\F_p$.  By doubling the phase-free picture using the CPM construction, we obtain a semantics for Weyl-free odd-prime dimensional qudit stabilizer circuits: Lagrangian relations over $\F_p$.  The Weyl operators are introduced to this picture by adding affine shifts to obtain a prop of affine Lagrangian relations. To add quantum discarding, we showed that one doesn't need to take the CPM construction again, but it suffices to add the discard {\em relation} to obtain the prop of affine coisotropic relations.  By splitting idempotents, we recover measurement; which has a nice relational interpretation.  Using this relational interpretation of mixed stabilizer circuits, we showed how stabilizer error correction protocols can be implemented.


In Chapter \ref{chap:grothendieck}, we regard monoidal categories as certain categorified Frobenius algebras in profunctors; the bicategory profunctors being itself a categorification of relations.  We conjecture that there is a confluent normal form for these structures, categorifying the spider theorem for special Frobenius algebras.  By regarding this spider theorem as a monoidal displayed category, we compute the B\'enabou-Grothendieck construction, and split idempotents, to obtain a strict monoidal category which is very close to proof nets for monoidal categories. We discuss the relation to the scalable ZX-calculus.

In Chapter \ref{chap:conclusion} we discuss future work and the limitations of this thesis.


%
%There is a conceptual advantage to modelling these fragments in terms of categories of spans or relations:  this perspective illuminates some of the most elegant symmetries of the ZX and ZH.
%
%For example, \dag-Frobenius algebras in $\FHilb$, which are used to express orthonormal bases are shown to arise from a colimit in such a fragment.  Moreover, the Euler decomposition of the Fourier transform is shown to arise from the hopf law.
%
%The CPM construction, which is traditionally used to model density matrices using monoidal categories, also surprisingly plays various roles in our presentations of these fragments of quantum circuits.  Not only does it allow one to mix, quantum circuits, a very closely related construction adds the plus state to partial, reversible boolean circuits.  Perhaps more surprisingly, the CPM construction also captures the notion of the Fourier transform, and Euler decomposition; when it is applied to phase-free circuits: ie, circuits which correspond to linear subspaces of $\F_p$-vector spaces.
%
%Finally, we conclude the thesis by regarding {\em quantum protocols themselves} as a generalized category of relations.  The machinery involved in this case is the bicategory of profunctors: which can be thought of as bimodules of categories.  This gives a structural account of the scalable ZX-calculus, which is used to parametrize families of circuits using string diagrams.  In particular, this is a limit over profunctors: an instance of the so called Benabou-Grothendieck construction.  Because of the generality at which this is proven, we suggest applications in other domains where string diagrams are used. 

\

{\bf \large  Declaration of authorship}

\

Chapter \ref{chap:background} is a literature review.  Chapter \ref{chap:zxa} contains work written solely by the author of this thesis with Sections \ref{sec:cpm}-\ref{sec:ZXA} of Chapter \ref{chap:zxa} being adapted from conference proceedings \cite{zxa}.  Chapter \ref{chap:stab} contains work jointly coauthored with my supervisor Aleks Kissinger, published in conference proceedings \cite{lagrel}.  The final part of Chapter  \ref{chap:stab} after and including Section \ref{sec:coisotrel} as well Chapter \ref{chap:grothendieck} contains work solely by the author of this thesis.



\chapter{Background}


\label{chap:background}
In order to understand this thesis, we will assume only basic knowledge of category theory and quantum computing.  I intend for most of this thesis to be understandable by an average theoretical computer scientist  (given that they read the most of this chapter); except for some parts to be understood by category theorists.


Although we formally state the various categorical constructions which are used throughout this thesis, in almost all cases the accompanying string diagrams also help give intuition to the reader.  The exception to this rule is the somewhat more technical  material on internal category theory and distributive laws of monoidal theories reviewed in Subsection \ref{subsec:internal} and used in Section \ref{sec:dist}.  For this, we assume some basic understanding of bicategories.  The most category theory heavy material is contained in Chapter \ref{chap:grothendieck} and assumes understanding of monoidal bicategories.  However, both of these parts stand on their own and are not needed to understand the rest of this thesis.

As far as quantum theory is involved, in Section \ref{sec:cqm} we will introduce everything from first reviewing the traditional algebraic paradigm, followed by a translation into string diagrams.

As a matter of notation, given two composable maps $f:X\to Y$ and $g:Y \to Z$, we will denote their diagrammatic composition using a semicolon as follows $f;g:X\to Z$. This notation for composition will be prefered throughout this thesis; except when talking about quantum circuits.  In this setting, to agree with the conventional notation we will denote their contravariant composition by concatenation as follows $gf:X\to Y$.



\input{background_chapter}

\chapter{Boolean circuits as spans of finite sets}
\label{chap:zxa}
\input{zxa_chapter}

\section{Decomposing Boolean circuits}
\label{sec:dist}
\input{decomposing_zx_chapter}

\chapter{Stabilizer codes as affine cosiotropic relations}
\label{chap:stab}
\input{symplectic_chapter}

\chapter{Proof nets and categorified Frobenius algebras}
\label{chap:grothendieck}
\input{grothendieck_chapter}

\chapter{Conclusion}
\label{chap:conclusion}


In this thesis, we have given nondeterministic semantics for two classes of quantum circuits.  


First, we gave a presentation $\ZXA$ for the  class of qubit circuits generated by the Toffoli gate, the not gate as well as the states $|0\rangle, \sqrt 2 |+\rangle$ and effects $\langle 0 |, \langle +|\sqrt{2}$.  We showed that this is isomorphic to the full subcategory of spans of finite sets (or equivalently matrices over the natural numbers) where the objects are powers of the 2 element set.  We also imposed a quotient to give a presentation for the full subcategory of relations of finite sets (or equivalently matrices over the Boolean semiring) where the objects are powers of the 2 element set.  In order to prove this, we gave a simpler characterisation of the Cartesian completion of a discrete inverse category: which is one half of the equivalence between partially reversible and partial computing with copying.  We restated this construction in terms of freely adding units to the diagonal maps; and showed how this can be related to the construction of stochastic systems from quantum systems.  We analyse the interaction of all of these generators and show how larger and larger fragments of $\ZXA$ can be constructed incrementally using pushouts and distributive laws; revealing the different nondeterministic/partial structures which occur along the way.


Secondly, we investigated the structure of stabilizer circuits; and showed how quopit stabilizer circuits are isomorphic to the prop of affine coisotropic relations over $\F_p$.  To perform this, we investigated the structure of the props of (affine) (co)isotropic and Lagrangian relations using graphical linear/affine algebra and the tools of categorical quantum mechanics.  We gave generators for the each of these props and showed how over prime fields, Lagrangian relations can be presented as the CPM construction applied to linear relations with respect to the orthogonal complement.  We show that doubling the prop of (affine) Lagrangian relations again with respect to the symplectic generalization of complex conjugation, given any base field, yields the prop of (affine) coisotropic relations.  We showed how by splitting the idempotents for the decoherence maps of the Z or X bases in this setting we obtain a multisorted prop where the state preparation and measurement maps have nice relational interpretations.  We show how this gives a graphical semantics for stabilizer codes which are broadly used for quantum error correction.  Also we relate this semantics of stabilizer circuits to relational categorical semantics for electrical circuits.

In both of these two examples, these props are not only monoidal categories, but there are 2-cells between the maps themselves specifying when circuits with constrained behaviour can be coherently transformed into less constrained circuits.

In this thesis, we also attempt to give a high level categorical account of proof nets for monoidal categories; the scalable ZX-calculus being one such example.  Given a monoidal category, we first  regarded it as a monoidal lax normal functor into $\Prof$ (itself a categorification of sets and relations). This regards monoidal categories as certain lax Frobenius algebras in $\Prof$. We use the B\'enabou-Grothendieck construction to obtain a strict monoidal category which is very close to the strictification of of a monoidal category in \cite{wilson}.  
There are several threads in this thesis which are still open.

First, is to generalize $\ZXA$ to qudits; providing semantics for other full subcategories of spans and relations of finite sets/matrices over the natural numbers and Booleans.  Of course by splitting idempotents we would obtain presentations for matrices over the naturals and Booleans; however, the structure would be encoded in bits.  The question is to find satisfying well-structured presentations of these categories, not an encoding of base $n$ arithemetic in base $2$.  Doing so would potentially be the first step in proving completeness for qudit fragments of the ZH-calculus.  I hinted at a potential way to solve this by computing Gr\"obner bases string-diagrammatically.  

This way of viewing the natural-number fragments of the ZH-calculus hints at the span/relational semantics of non-prime dimensional stabilizer fragments of the  ZX-calculus.  When we presented stabilizer circuits in terms of affine Lagrangian relations, we required that the dimension be prime (or odd prime when we wanted to express phase-gates and Fourier transforms).  The requirement that the dimension be prime is needed in order for the categories of matrices and its possibly empty affine counterpart to be regular categories.  Indeed,  when a ring is not a principal ideal domain, it is not clear if these categories are even finitely complete.  However, just as in the qubit case $\ZXA$ is the full subcategory of spans of finite sets/matrices over the natural whose objects are powers of 2; one could do the same for qudits for any $d$.  This begs the question: what are the {\em linear} and {\em affine} full subcategories of matrices over the naturals and Booleans where the objects are powers of some natural number $d$.  There are both covariant and contravariant monoidal embeddings of $(\Aff\Mat_{\Z/d\Z},\oplus)$ / $(\Mat_{\Z/d\Z},\oplus)$ into $(\Mat_\N,\otimes)$ / $(\Mat_\B,\otimes)$.  What are presentations for the pushout of these two embeddings?  Does this give any insight in how to construct something close to linear/affine spans/relations over arbitrary rings?

We also did not give a completely satisfying investigation into the connection between the two-sided (co)unital completion of the inverse products of a discrete inverse category and Cartesian bicategories (of the span-variety, not of relations).  In general, it is natural to ask: when one takes the subcategory of partial isomorphisms of a Cartesian bicategory, when will the original Cartesian bicategory be recovered by adding units and counits to the inverse products.  It is enough to impose that the unit and counits be adjoint to each other, or will information about the original Cartesian bicategory be lost?


In terms of stabilizer circuits there are also many unanswered questions.  First, the most obvious is the lack of undoubled presentation for the prop of affine coisotropic relations.  This will not be too hard to do, given the recent developments on presenting quopit stabilizer circuits, as discussed in Section \ref{sec:conclagrel}.  This is a very important thing to work out, because of the close connection to Gaussian quantum mechanics.  This would likely lead to ZX-calculi for continuous variable quantum mechanics.  Even outside of the realm of quantum mechanics, giving  a relational semantics thereof will possibly shed more light on the connection between Gaussian probability and nondeterminism as in the work of \cite{stein}.


It would also be really interesting to augment our two coloured semantics for stabilizer circuits and affine classical processing with stronger classical processing.  If the relational semantics for $p$-mode nonlinear classical nondeterministic circuits were combined with quopit stabilizer circuits, this would provide a very interesting millieu between stabilizer quantum mechanics and full mixed quantum theory.  That is to say, the fragment where the scientist in the lab has access to stabilizer quantum operations, Z and X measurements, state preparations and phase-corrections; but with nonlinear classical nondeterministic post-processing.  Generally, the classical and quantum systems are put on different footings; so to the knowledge of the author the structure of this intermediate class of quantum circuits has not even been noticed, let alone explored.

Also in our categorical analysis of stabilizer codes, we have not given a graphical/categorical account of code distance, which of great practical importance in quantum error correction. 

Finally, we have made some steps into giving high-level categorical semantics for proof nets for monoidal categories/the scalable ZX-calculus.  The goal of this work was to attempt to find ways to glue different monoidal categories together so that one can work with string diagrams for multiple monoidal categories within the same setting.  This would be interesting not only from a quantum perspective, but from the broader perspective of a computer scientists who uses string diagrams as a tool for their work.  Although this work is far from finished, we hope that in the future it could lead to the development of more rich graphical calculi where the interfaces between two different systems, regarded as monoidal functors between monoidal categories can induce presentations for richer monoidal categories.







\bibliography{bibliography}
\bibliographystyle{eptcs}
\end{document}
