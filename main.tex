% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.
\errorcontextlines=500

\documentclass[12pt]{ociamthesis}  % default square logo 

%\documentclass[a4paper,11pt,oneside]{bo222ok}
%\usepackage[DIV=14,BCOR=2mm,headinclude=true,footinclude=false]{typearea}

\input{preamble}

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)


\title{Relational Semantics for Quantum Protocols}
\author{Cole Comfort}
\college{New College}  %your college
\degree{Doctor of Philosophy in Computer Science} 
\degreedate{????? 2023}    

%\renewcommand{\submittedtext}{change the default text here if needed}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 





%introduction
%  motivation behind relational interpretations
%basic category theory
%  Monoidal categories and compact closed categories
%    Definitions
%    Strictification
%      string diagrams for strict monoidal categories
%      Proof nets for non strict monoidal categories
%    Process theoretic interpretation
%      Space and time
%    Monoidal theories
%      Finite sets
%  Spans and relations
%     Spans and cospans of finite sets and frobenius algebras
%     Linear relations, affine relations and their monoidal theories
%     Cartesian restriction categories
%     Discrete inverse categories
%       Cartesian completion and Para construction
%     Cartesian bicategories
%Internal categories
%  Monads
%  Internal categories
%  Distributive laws
%    Distributive laws of monoidal categories
%  Bimodules of monads (internal profunctors)
%    Distributive laws of symmetric monoidal categories
%Categorical quantum mechanics
%  Finite dimensional hilbert spaces and their strictification to complex matrices
%  Dagger compact closed structure
%  Isometries, unitary evolution and quantum observables
%  CPM construction and splitting dagger idempotents as measurement
%  Z and X observables
%  Stabilizers as +1 eigenvectors
%  Joint stabilizers and the stabilizer formalism
%  ZX-calculus
%    Phase-free ZX calculus
%       Phase-free ZX-calculus and linear relations
%    Z and X fragments
%       Affine relations
%    Stabilizer ZX-calculus
%      Hint at Symplectic algebra
%  ZH-calculus
%    Hint at ZX& construction
%  Discard construction
%ZX&-calculus
%Graphical symplectic algebra
%Deconstructing things using distributive laws
%Conclusion
% Hint at combining ZX& and stabilizer ZX-calculus to get nonlinear processing

%TODO
%Standardize tensor product for linear relations (tensor, direct sum, addition on objects)
%Give better exposition of the symplectic formalism in the introduction
%  Talk about spekkens toy model more and the divergence between the stabilizer formalism in odd dimensions in the symplectic algebra chapter
%Give examples of error correcting codes and protocols with affine and non-affine classical processing
%Talk about ZX& calculus as being stabilized by nonlinear set of X operators.
%Talk about combining stabilizer codes with classical processing
%L2 function in weil representation of ZXA and stabilizers
%Change words white and grey to inline tikz circles

%give a nontechnical overview at the beginning of each section (for example, string diagrams from a graphical perspective) Put these resumes in special boxes

%Also put axioms in special boxes

\usepackage{showframe}


\setenumerate{align=left}

\begin{document}
\maketitle

\sloppy

\begin{abstract}
In this thesis we exhibit nondeterministic semantics for fragments of quantum circuits.  First, we show that the class of circuits generated by Toffoli gates as well as state prepration and postselection in the Z and X basis is characterized in terms of spans of finite sets. With this semantics in mind, we discuss the connection to partial and reversible computation. We also exhibit an isomorphism between the prop of affine coisotropic relations over odd prime fields and odd-prime-dimensional mixed stabilizer circuits.   We show how this is closely related to previously known semantics for idealized classes of electrical circuits.  
\end{abstract}


\tableofcontents


\chapter{Introduction}
\label{chap:intro}


The traditional paradigm for quantum computing decomposes a quantum computation into three separate stages. First, a quantum state is prepared in the lab; second the state is evolved by applying unitary operations; and finally, the quantum state is measured according to the Born rule.  This is a relatively rigid model, where the three stages are all modelled by different kinds of mathematical objects.  Moreover, the born rule entails that the measurements depend {\em probabilistically} on the choice state preparation and unitary evolution.

In this thesis, we model quantum computation in the more flexible quantum circuit model, where the state preparation, evolution and measurement all live on similar footing.  More precisely, departing from most treatments of quantum circuits, we regard all three stages of a quantum computation as certain subspaces, where subspaces are composed by tracing out the common elements in the intersection of the subspaces.  Two types of subspaces appear in this thesis, namely subsets of finite sets and affine subspaces of affine vector spaces over finite fields.  We associate the Hilbert space of square-integrable functions to these spaces; and the subspaces correspond to the {\em nondeterministic} evolution of the system.  That is to say, by regarding these classes of quantum circuits as subspaces, the inputs and outputs are associated to each other with respect to which output is {\em possible} from which input.

In Chapter \ref{chap:background}, we review the mathematical background which is needed to understand this thesis.  In Section \ref{sec:cat}, we give a brief review of category theory.  We first review the theory of monoidal categories and string diagrams which gives allows us to regard circuits as abstract mathematical objects.  Next we review categories of spans and relations, which gives our mathematical semantics for circuits with nondeterministic evolution.  Finally in Section \ref{sec:cqm}, we review some of the basic results in categorical quantum mechanics: which relates monoidal categories and string diagrams to quantum computing. This entails giving an overview of the language for quantum circuits known as the {\em ZX-calculus}; as well as reviewing the mathematical machinery needed to model mixed states and measurement within this framework.

In Chapter \ref{chap:zxa} we analyze the class of quantum circuits generated by the Toffoli gate as well as state preparation and post selection in the $Z$ and $X$ basis.  We give a complete presentation for this category and interpret it in terms of spans of finite sets.  We show that this class of circuits has very close to a nondeterministic semantics, except where outcomes can happen multiple times.  By imposing an additional equation, we depart from the interpretation into Hilbert spaces, and obtain a semantics with a proper {\em nondeterministic} semantics in terms of relations between finite sets. We then decompose this presentation into small fragments; composing them incrementally via distributive law and pushout.
We exhibit substructural features of these various decompositions and discuss how by allowing only some of the generators, we obtain semantics which are partial, partially invertible and so on; associating classes of generators to different semantic paradigms of computation.


Finally in Chapter \ref{chap:stab}  we analyze the structure of odd-prime dimensional stabilizer circuits.
We expose the relational interpretation of these circuits, by adding generators: at each point, obtaining a richer semantics.  We first recall that the phase-free fragment of the ZX-calculus modulo scalars, for prime qudit dimension $p$ is isomorphic to the prop of linear relations over $\F_p$: ie where the maps are linear subspaces over $\F_p$.  By doubling the phase-free picture using the CPM construction, we obtain a semantics for Weyl-free odd-prime dimensional qudit stabilizer circuits: Lagrangian relations over $\F_p$.  The Weyl operators are introduced to this picture by adding affine shifts to obtain a prop of affine Lagrangian relations.  Finally, to add quantum discarding, we show that one doesn't need to take the CPM construction again, but it suffices to add the discard {\em relation} to obtain the prop of affine coisotropic relations.  By splitting idempotents, we recover measurement; which has a nice relational interpretation.  Using this relational interpretation of mixed stabilizer circuits, we show how stabilizer error correction protocols can be implemented.


In Chapter \ref{chap:grothendieck}, we regard monoidal categories as certain categorified Frobenius algebras in profunctors; the 2-category profunctors being itself a categorification of relations.  We conjecture that there is a confluent normal form for these structures, categorifying the spider theorem for special Frobnenius algebras.  By regarding this spider theorem as a monoidal displayed category, we compute the Grothendieck Benabou construction, and split idempotents, to obtain a strict monoidal category which is very close to proof nets for monoidal categories. We discuss the relation to the scalable ZX-calculus as well as avenues for future work.

In Chapter \ref{chap:conclusion} we discuss future work and the limitations of this thesis.


%
%There is a conceptual advantage to modelling these fragments in terms of categories of spans or relations:  this perspective illuminates some of the most elegant symmetries of the ZX and ZH.
%
%For example, \dag-Frobenius algebras in $\FHilb$, which are used to express orthonormal bases are shown to arise from a colimit in such a fragment.  Moreover, the Euler decomposition of the Fourier transform is shown to arise from the hopf law.
%
%The CPM construction, which is traditionally used to model density matrices using monoidal categories, also surprisingly plays various roles in our presentations of these fragments of quantum circuits.  Not only does it allow one to mix, quantum circuits, a very closely related construction adds the plus state to partial, reversible boolean circuits.  Perhaps more surprisingly, the CPM construction also captures the notion of the Fourier transform, and Euler decomposition; when it is applied to phase-free circuits: ie, circuits which correspond to linear subspaces of $\F_p$-vector spaces.
%
%Finally, we conclude the thesis by regarding {\em quantum protocols themselves} as a generalized category of relations.  The machinery involved in this case is the 2-category of profunctors: which can be thought of as bimodules of categories.  This gives a structural account of the scalable ZX-calculus, which is used to parametrize families of circuits using string diagrams.  In particular, this is a limit over profunctors: an instance of the so called Benabou-Grothendieck construction.  Because of the generality at which this is proven, we suggest applications in other domains where string diagrams are used. 

\

{\bf \large  Declaration of authorship}

\

Chapter \ref{chap:background} is a literature review.  Chapter \ref{chap:zxa} contains work written solely by the author of this thesis with Sections \ref{sec:szx:intro}-\ref{sec:ZXA} of Chapter \ref{chap:zxa} being adapted from conference proceedings \cite{zxa}.  Chapter \ref{chap:stab} contains work jointly coauthored with my supervisor Aleks Kissinger, published in conference proceedings \cite{lagrel}.  The final part of Chapter  \ref{chap:stab} after and including Section \ref{sec:coisotrel} contains original work of my own. Chapter \ref{chap:grothendieck} contains work solely by the author of this thesis.



\chapter{Background}


\label{chap:background}
In order to understand this thesis, we will assume only basic knowledge of category theory and quantum computing.  I intend for most of this thesis to be understandable by an average theoretical computer science; except for some parts to be understood by category theorists.


Although, we formally state the various categorical constructions which are used throughout this thesis, in almost all cases, the accompanying string diagrams also help give intuition to the reader.  The exception to this rule is the somewhat more technical  material on internal category theory and distributive laws of monoidal theories reviewed in Subsection \ref{subsec:internal} and used in Section \ref{sec:dist}.  For this, we assume some basic understanding of 2-categories.  The most category theory heavy material is contained in Chapter \ref{grothendieck_chapter} and assumes understanding of monoidal 2-categories.  However, both of these parts stand on their own and are not needed to understand the rest of this thesis.

As far as quantum theory is involved, in Section \ref{sec:cqm} we will introduce everything from scratch using the traditional algebraic paradigm, followed by a translation into string diagrams.



\input{background_chapter}

\chapter{Boolean circuits as spans of finite sets}
\label{chap:zxa}
\input{zxa_chapter}

\section{Decomposing Boolean circuits via distributive law}
\label{sec:dist}
\input{decomposing_zx_chapter}

\chapter{Stabilizer codes as affine cosiotropic relations}
\label{chap:stab}
\input{symplectic_chapter}

\chapter{Categorified Frobenius algebras}
\label{chap:grothendieck}
\input{grothendieck_chapter}

\chapter{Conclusion}
\label{chap:conclusion}

\bibliography{bibliography} 
\bibliographystyle{eptcs}
\end{document}
