
\subsection{Categories of spans and relations}
\label{subsec:spanrel}
Categories are defined in a manner which distinguishes the inputs and outputs of maps.  \dag-categories are one approach to moving beyond this bias; however, they are evil in the sense that the \dag-structure is not always preserved/reflected by categorical equivalence.

Spans and relations provide a categorically well-behaved, flexible setting with which to interpret processes without elevating inputs over outputs.
Whereas functions produce unique outputs from inputs, spans and relations nondeterministicaly associate several inputs with several outputs.  To introduce these mathematical constructions.
All of the category theory in this subsection which is not explicitly cited is standard and can be found, for example, in most introductions to category theory; for example \cite{maclane}.
We first need to recall some basic facts about limits.
\begin{definition}
\label{def:cart}
The {\bf product} of two objects $X$ and $Y$ (if it exists) in some category, is an object $X\times Y$ equipped with maps $\pi_0:X\times Y\to X $ and $\pi_1:X\times Y \to Y$ called the {\bf projections},  such that for any object $A$ and diagram  $X \xleftarrow{f} A \xrightarrow{g} Y$ there exists a unique map $\langle  f, g \rangle :A \to X\times Y$ called {\bf the pairing map} making the following diagram commute:
$$
\xymatrix{
    &
    & A \ar[lld]_f \ar[rrd]^g \ar@{-->}[d]^{\langle f,g\rangle}
    &
    &
  \\X 
    &
    & X\times Y \ar[ll]^{\pi_0} \ar[rr]_{\pi_1}
    &
    & Y
}
$$ 
Given two maps $f:W\to X$ and $G:Y\to Z$, their product is defined to be the universal map $f\times g:W\times Y \to X\times Z$: 
$$
\xymatrix{
    W \ar[d]_f
    &
    & W\times Y \ar@{-->}[d]^{f\times g} \ar[ll]_{\pi_0} \ar[rr]^{\pi_1}
    &
    & Y \ar[d]^g
  \\X
    &
    & Y\times Z  \ar[ll]_{\pi^0} \ar[rr]_{\pi_1}
    &
    &Z
}
$$
The {\bf diagonal map} at $X$ is the pairing map on the identity $\Delta_X:=\langle X,X\rangle$.  A {\bf terminal object} in a category (if it exists) is an object $\one$ equipped with a unique map $!_X:X\to \one$ for every object $X$ called the {\bf discard map} or the {\bf terminal map}.
A category is  {\bf Cartesian} when it has all finite products and a terminal object. %In a Cartesian category, the discard maps and {\bf diagonals} $\Delta:=\langle 1, 1 \rangle$ yield a natural family of commutative monoids.


%A category $\X$ is {\bf coCartesian} when $\X^\op$ is Cartesian.

%The products/projections/pairing maps/terminal objects/diagonal maps in $\X$ are respectively called {\bf coproducts}/{\bf injections}/{\bf copairing maps}/{\bf initial objects}/{\bf codiagonal maps} in $\X^\op$.


Let us spell out the dual notion in order to establish the dual notations.
The {\bf coproduct} in $\X$ is the product in $\X^\op$:
$$
\xymatrix{
    &
    & A
    &
    &
  \\X \ar[urr]^{f} \ar[rr]_{\iota_0}
    &
    & X+  Y \ar@{-->}[u]_{[f,g]} 
    &
    & Y\ar[ull]_{g}  \ar[ll]^{\iota_1}
}
$$ 
Where $ X+  Y $ is the product object.%,  $\iota_0,\iota_1$ are the injections,   $[f,g]$ is the copairing map.
An {\bf initial object} in a category (if it exists) is an object $\emptyset$ equipped with a unique map $?_X: \emptyset\to  X$. %for every object $X$ called the {\bf codiscard map}.
A category is  {\bf coCartesian} when it has all finite coproducts and an initial object.% In aco Cartesian category, the codiscard maps and {\bf codiagonals} $[ 1, 1 ]$ yield a natural family of cocommutative comonoids.
\end{definition}
\begin{example}
$\Sets$ and  $\FSets$ are Cartesian with respect to the Cartesian product:
$$X\times Y := \{(x,y) \ | \ \forall x\in X, y \in Y\}$$
They are coCartesian with respect to the disjoint union
$$X+Y := \{ (x,1) \ | \ \forall x \in X \} \cup  \{ (y,2) \ | \ \forall y \in Y \}$$
Similarly, $\FVect_k$ and $\Mat_S$ are Cartesian and coCartesian both with respect to the direct sum.
\end{example}
A Cartesian category is precisely a monoidal category which allows one to copy and delete things in a manner which is deterministic and total:
\begin{lemma}
A category is Cartesian iff it is has a symmetric monoidal structure equipped with a  cocommutative comonoid $\zcirc$ on every object (see Example \ref{example:monoid})  compatible with the monoidal structure, so that
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (0, 2.5) {};
		\node [style=none] (1) at (1, 2.5) {};
		\node [style=Z] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
		\draw [style=simple, in=-90, out=117] (2) to (0.center);
		\draw [style=simple, in=63, out=-90] (1.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 2.5) {};
		\node [style=Z] (1) at (1, 2.5) {};
		\node [style=none] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
		\node [style=none] (4) at (0, 3.5) {};
		\node [style=none] (5) at (1, 3.5) {};
		\node [style=none] (6) at (0, 4.5) {};
		\node [style=none] (7) at (1, 4.5) {};
		\node [style=otimes] (8) at (0.5, 1.5) {};
		\node [style=otimes] (9) at (1, 3.5) {};
		\node [style=otimes] (10) at (0, 3.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2.center);
		\draw [style=simple, in=-90, out=135] (2.center) to (0);
		\draw [style=simple] (0) to (5.center);
		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
		\draw [style=simple] (1) to (4.center);
		\draw [style=simple, in=45, out=-90] (1) to (2.center);
		\draw [style=simple] (4.center) to (6.center);
		\draw [style=simple] (5.center) to (7.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (2) at (1, 1.5) {};
		\node [style=none] (3) at (1, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (4) at (2.5, 2.5) {};
		\node [style=Z] (5) at (3.5, 2.5) {};
		\node [style=none] (6) at (3, 1.5) {};
		\node [style=none] (7) at (3, 0.5) {};
		\node [style=otimes] (12) at (3, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (7.center) to (6.center);
		\draw [style=simple, in=-90, out=135] (6.center) to (4);
		\draw [style=simple, in=45, out=-90] (5) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
%$$
%\begin{tikzpicture}[xscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (9) at (7.25, -1.5) {};
%		\node [style=none] (11) at (7.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (11.center) to (9.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitr}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{assoc}
%\begin{tikzpicture}[scale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{comm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}$$
Where the comultiplication and counit are also natural, so that for any map $f$:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (12) at (2, 0) {};
		\node [style=none] (15) at (2.5, 0.75) {};
		\node [style=none] (17) at (2, -0.75) {};
		\node [style=none] (18) at (1.5, 0.75) {};
		\node [style=map] (19) at (2, -0.75) {$f$};
		\node [style=none] (20) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (17.center) to (12);
		\draw [in=-90, out=30] (12) to (15.center);
		\draw [in=150, out=-90] (18.center) to (12);
		\draw (20.center) to (17.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (3.75, -0.75) {};
		\node [style=none] (22) at (4.25, 0) {};
		\node [style=none] (23) at (3.75, -1.5) {};
		\node [style=none] (24) at (3.25, 0) {};
		\node [style=map] (25) at (3.25, 0) {$f$};
		\node [style=map] (27) at (4.25, 0) {$f$};
		\node [style=none] (28) at (3.25, 0.75) {};
		\node [style=none] (29) at (4.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (23.center) to (21);
		\draw [in=-90, out=30] (21) to (22.center);
		\draw [in=150, out=-90] (24.center) to (21);
		\draw (28.center) to (25);
		\draw (29.center) to (27);
	\end{pgfonlayer}
\end{tikzpicture} \ ,
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (2, 0) {};
		\node [style=none] (2) at (2, -0.75) {};
		\node [style=map] (4) at (2, -0.75) {$f$};
		\node [style=none] (5) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (2.center) to (0);
		\draw (5.center) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (6) at (3.75, -0.75) {};
		\node [style=none] (8) at (3.75, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (8.center) to (6);
	\end{pgfonlayer}
\end{tikzpicture}
$$

The comonoid corresponds to the diagonal map and the counit corresponds to the discard map.
\end{lemma}

Therefore, when we gave presentations for $\FinOrd$ and $\Mat_S$; the natural white commutative comonoid is precisely the one coming from the Cartesian structure.  The naturality of the diagonal map corresponds to determinism, and the naturality of the discard corresponds to totality.  We will come back to this shortly.



As we alluded to in the introduction of this subsection, the Cartesian notion of copying biases inputs over outputs, and the coCartesian notion of comparison biases outputs over inputs.  We are interested in a more permissive (partial and nondeterministic), symmetric notion of copying, which is compatible with \dag-structure. The following construction allows us to develop such a structure; generalizing the product modulo shared structure:
\begin{definition}
The {\bf pullback} of a diagram  $X \xrightarrow{f} A \xleftarrow{g} Y$ (if it exists) is an object $X\ {}_f \times_{g} Y$ called the {\bf apex} and maps $\pi_0:X\ {}_f \times_{g} Y\to X$ and  $\pi_1:X\ {}_f \times_{g} Y\to Y$ called {\bf the  projections}, such that for any diagram $X \xleftarrow{p_0} P \xrightarrow{p_1} Y$ making the the following diagram commute,
{\xymatrixrowsep{0mm}
$$
\xymatrix{
    &
    & B   \ar[dll]_{p_0} \ar[drr]^{p_1}
    &
    &
  \\X \ar[drr]_f 
    &
    & 
    &
    & Y  \ar[dll]^{g}
  \\
    &
    & A
    &
    & 
}
$$}
there exists a unique map $u: P\to X\ {}_f\times_g Y $ making the following diagram commute:
$$
\xymatrix{
    &
    & P \ar@/_/[ddll]_{p_0}  \ar@/^/[ddrr]^{p_1} \ar@{-->}[d]^{u}
    &
    &
  \\
    &
    & X\ {}_f \times_{g} Y  \ar[dll]_{\pi_0} \ar[drr]^{\pi_1} \pullbackcorner[d]
    &
    &
  \\X \ar[drr]_f 
    &
    & 
    &
    & Y \ar[dll]^g 
  \\
    &
    & A
    &
    & 
}
$$
Where a chevron is drawn under the apex of the span to denote that the square is a pullback.
A category is {\bf finitely complete} if it has a terminal object and all pullbacks exist. Notice that product $X\times Y$ is the pullback of the diagram $X \rightarrow 1 \leftarrow Y$.
The dual notion of a pullback is a {\bf pushout}; the pushout of a diagram $X\xrightarrow{f} A \xleftarrow{g} Y$ is denoted by $X{}_f +_{g} Y$.
We draw a chevron on the apex of the cospan, to denote that a square is a pushout as follows:
$$
\xymatrix{
    &
    & P 
    &
    &
  \\
    &
    & X\ {}_f +_{g} Y \ar@{-->}[u] \pullbackcorner[d]
    &
    &
  \\X \ar[urr]^{\iota_0} \ar@/^/[uurr]^{i_0}
    &
    & 
    &
    & Y \ar[ull]_{\iota_1} \ar@/_/[uull]_{i_1}
  \\
    &
    & A \ar[urr]_{g} \ar[ull]^{f}
    &
    & 
}
$$
\end{definition}
\begin{example} 
In $\Sets$ the pullback of a cospan $X \xrightarrow{f} A \xleftarrow{g} Y$ is (up to unique isomorphism) the set:
$$\{(x,y) \in X\times Y : f(x) = g(y)\}$$
The pushout of a  span $X \xleftarrow{f} A \xrightarrow{g} Y$ is the quotient of the set $X+Y$ by:
$$f(a)\sim g(a) \text{ \ \ for all } a \in A$$

The concrete pullback/pushout of matrices is essentially the same with the direct sum instead of the Cartesian product/disjoint union.
\end{example}
Spans form a bicategory under pullback:
\begin{definition}
\label{def:span}
Given a finitely complete category $\X$, the bicategory of spans $\Span(\X)$ has:
\begin{description}
\item[0-cells:] Objects of $\X$.
\item[1-cells:] 1-cells $(A,f,g):X\to Y$ are spans in $\X$ from $A$:
{\xymatrixrowsep{0mm}
$$
\xymatrix{
    & A \ar[dl]_{f} \ar[dr]^{g}
    &
  \\X 
    &
    & Y
}
$$}
Composition is induced by pullback:

{
\xymatrixrowsep{2mm}
$$
\xymatrix{
    & A\ar[dl]_{f} \ar[dr]^{g}
    &
  \\X 
    &
    & Y
}\ ;\
\xymatrix{
    & B\ar[dl]_{h} \ar[dr]^{k}
    &
  \\Y 
    &
    & Z
}
:=
\xymatrix{
    &
    & A {}_g\times_k B \ar[dl]_{\pi_0} \ar[dr]^{\pi_1} \pullbackcorner[d]
    &
    &
  \\
    & A \ar[dl]_{f} \ar[dr]^{g}
    &
    & B \ar[dl]_{h} \ar[dr]^{k}
    &
  \\X
    &
    & Y
    &
    & Z
}
$$}
The identity on $X$ is given by the span:
{\xymatrixrowsep{0mm}
$$
\xymatrix{
    & X \ar@{=}[dl] \ar@{=}[dr] 
    &
  \\X 
    &
    & X
}
$$}
%ooPoo
%oAoBo
%XoYoZ
\item[2-cells:] A 2-cell $\phi:(A,f,g)\Rightarrow (B,h,k)$ between parallel spans is a map $f:A\to B$ in $\X$ such that the following diagram commutes:
{
\xymatrixrowsep{2mm}
$$
\xymatrix{
    & A \ar[dl]_{f} \ar[dr]^{g} \ar[dd]^{\phi}
    &
  \\X 
    &
    & Y
  \\
    & B \ar[ul]^{h} \ar[ur]_{k}
    &
}
$$}
The composition and identity of  2-cells is given by the composition and identity in $\X$.
\end{description}
The composition of 1-cells is not strict, so that the associativity and unitality of composition hold up to coherent isomorphism.  The coherence isomorphisms are the canonical 2-cells induced by the universal property of the pullback.


The ordinary category of spans of $\X$, $\Span^\sim(\X)$, has maps being equivalence classes of isomorphic spans; so that,
$$
(X\xleftarrow{f} A \xrightarrow{g} Y)
 \sim
(X\xleftarrow{h} B \xrightarrow{k} Y)
$$
if and only if there exists an isomorphism $A\xrightarrow{\phi} B$ such that the following diagram commutes:
$$
\xymatrix{
    & A \ar[dl]_{f} \ar[dr]^{g} \ar[dd]^{\phi}_{\cong}
    &
  \\X 
    &
    & Y
  \\
    & B \ar[ul]^{h} \ar[ur]_{k}
    &
}
$$
\end{definition}
$\X$ embeds in $\Span^\sim(\X)$ in two different ways.  Covariantly as the {\bf graph} and contravariantly as the {\bf cograph}:
$$
\left(X\xrightarrow{f} Y \right) 
\mapsto
\left( 
\xymatrix{
X & X\ar@{=}[l] \ar[r]^{f} & Y
}
\right)
,\hspace*{.2cm}
\left(X\xrightarrow{f} Y \right) 
\mapsto
\left( 
\xymatrix{
Y & X \ar@{=}[r] \ar[l]_f & X
}
\right)
$$
 Regarded as a monoidal category under the Cartesian product, the two embeddings turn the diagonal maps and discard maps into dag-Frobenius algebras, making  $\Span^\sim(\X)$  self-dual \dag-compact closed, where the \dag-functor is given by the converse  $(f,A,g)\mapsto (g,A,f)$.

For the interested reader, the monoidal structures (or lack thereof) of categories of cospans and and spans of sets is elaborated on in great detail in \cite{bruni}.

Categories of spans give mathematical semantics for nondeterministic processes where inputs are associated to possible outputs with multiplicity. 
A 2-cell between two processes thus describes a method to coherently transform one process into another.  For example:
\begin{example}
$\Span^\sim(\FSets)$ is \dag-symmetric monoidally equivalent to $\Mat_\N$ under both tensor products.
\end{example}
This example is quite useful for developing intuition.  Take a span of finite sets $X\xleftarrow{f} M \xrightarrow{g} Y$, where $X$ and $Y$ have a chosen order. This determines an $|X|\times |Y|$ matrix, where the entry at $(x,y)\in X\times Y$ is given by the cardinality of the preimage $\langle f,g\rangle^{-1}(X\times Y)$.  That is to say, the number of times $x$ and $y$ are related.



We seek moreover, to quotient by multiplicity, to obtain a semantics for honest nondeterministic processes: where things can be related at most once.  To do so, we need more assumptions about the category with which we seek to work internal to.
\begin{definition}
\label{def:mono}
A map $f:X\to Y$ is a {\bf monomorphism} (monic) when for all maps $g,h:Z\to X$, $g;f=h;f$ implies $ g=h$.

Dually, a map $f:X\to Y$ is an {\bf epimorphism} (epic) when for all maps $g,h:Y\to Z$, $f;g=f;h$ implies $ g=h$.

To add extra information to diagrams, we denote monomorphisms as arrows with tails $\rightarrowtail$ and epimorphisms as arrows with two heads $\twoheadrightarrow$.  
\end{definition}
Monomorphisms and epimorphisms are the categorically well-behaved analogues of injections and surjections; where a map is similarly an isomorphism when it is an epimorphism and a monomorphism.  In all of the examples we care about in this thesis, the monomorphisms are exactly the injections and the epimorphisms are exactly the surjections.  However, it is needed for a proper exposition of categories of relations.

There are  special kinds of monomorphisms and epimorphisms which come up:
\begin{definition}
The {\bf equalizer}, of two parallel maps $f,g:X\to Y$, if it exists, is an object $E_{f,g}$ equipped with a map $m:E_{f,g}\to X$ such that for all objects $F$ and maps $h:F\to E_{f,g}$, there exists a unique map $u:F\to A$ making the following diagram commutes:
$$
\xymatrix{
    F \ar@{-->}[dr]^{u} \ar[d]_h
  \\ E_{f,g} \ar@{>->}[r]_m
    & X \ar@<-.5ex>[r]_g \ar@<.5ex>[r]^f
    & Y
}
$$
The maps $m$ arising from equalizers are monomorphisms.  Monomorphisms arising this way are called {\bf regular monomorphisms}.
The dual notion to an equalizer is a {\bf coequalizer}, and the epimorphisms arizing in this way are called {\bf regular epimorphisms}.
\end{definition}
We have already been using coequalizers throughout this thesis whenever we impose equations by taking quotients.  Indeed:
\begin{example}
Sets and matrices both have equalizers and coequalizers.
In sets, the equalizer of two functions $g,f:X\to Y$ is (up to unique isomorphism) the set 
$$\{x \in X:f(x)=g(x)\} \subseteq X$$
The coequalizer is the quotient $Y/\sim$   of the set $Y$ by the equivalence relation 
$$f(x)\sim g(y)$$

The situation is essentially the same for matrices.
\end{example}
We  use coequalizers to ask for conditions in which categories have good notions of images and kernels:
\begin{definition}
Take a finitely complete category.  Construct the pullback of a map $f:X\to Y$ along itself:
 $$\xymatrix{X\ {}_f \times_f X  \ar@<-.5ex>[rr]_{\ \ \pi_1;f}  \ar@<.5ex>[rr]^{\ \ \pi_0;f}&& Y}$$
Call this diagram a {\bf kernel pair} at $f$, and call the object  the {\bf kernel} of $f$, denoted by $\ker(f):=X\ {}_f \times_f X$.
If the kernel pair at $f$ admits a coequalizer, call this object the {\bf image} of $f$, denoted by $\im(f)$.

A {\bf regular category} is a finitely complete category such that:
\begin{itemize}
\item Every kernel pair admits a coequalizer.
\item Pullbacks of arbitrary maps along regular epimorphisms are regular epimorphisms.
\end{itemize}
\end{definition}
\begin{example}
$\Sets$, $\FSets$, $\FVect_k$ and  $\Mat_k$ for $k$ a field (or more generally a principal ideal domain) are all regular categories.

In these examples, kernels and images are the usual notions of kernels and images.
\end{example}
\begin{lemma}
In a regular category, every map $f:X\to Y$ can be factorized into a regular epimorphism $e_f$ followed by a monomorphism $m_f$ up to unique isomorphism:
$$
\xymatrix{
X \ar@{->>}[rr]^{\hspace*{-.7cm}e_f} \ar[drr]_{f} &&{X/\ker{f}=:\co\im(f)} \ar@{>->}[d]^{m_f}\\
                                        &&Y
}
$$
\end{lemma}
\begin{definition}
\label{def:rel}
Given a regular category $\X$,  the strict 2-category of {\bf relations} internal to $\X$, $\Rel(\X)$ has:
\begin{description}
\item[0-cells:] Objects of $\X$.
\item[1-cells:] 1-cells $(A,f,g):X\to Y$ are jointly monic spans in $\X$ from $A$:
{
\xymatrixrowsep{0mm}
$$
\xymatrix{
    & A \ar[dl]_{f} \ar[dr]^{g}
    &
  \\X 
    &
    & Y
}
$$
}
This span being {\bf jointly monic} means that for any object $B$ and map $h,k:B\to A$ if $h;f=k;f$ and $h;g=k;g$, then $h=k$.

To compose jointly monic spans $(A,f,g):X\to Y$ and $(B,h,k):Y\to Z$,  first compute the pullback:
$$
\xymatrix{
    &
    & A\ {}_g\times_k B \ar@{->>}[dl]_{\pi_0} \ar@{->>}[dr]^{\pi_1} \pullbackcorner[d]
    &
    &
  \\
    & A \ar[dl]_{f} \ar[dr]^{g}
    &
    & B \ar[dl]_{h} \ar[dr]^{k}
    &
  \\X
    &
    & Y
    &
    & Z
}
$$
Composing with the pairing map we get a map $\langle \pi_0;f,\pi_1;k\rangle :A {}_g\times_k B \to X\times Z$.
Because $\X$ is a regular category, there is a factorization of $\langle \pi_0;f,\pi_1;k\rangle$ into an regular epimorphism followed by monomorphism:
$$
\xymatrix{
  A\ {}_g\times_k B \ar[drrr]^{\langle \pi_0;f,\pi_1;k\rangle}  \ar@{->>}[d]_{e:=e_{\langle \pi_0;f,\pi_1;k\rangle} }
  \\  E:=\co\im({\langle \pi_0;f,\pi_1;k\rangle} ) \ar@{>->}[rrr]_{\ \ \ \ \ \ \ \ \ \ \ m:=m_{\langle \pi_0;f,\pi_1;k\rangle} }
    &&&  X\times Z
}
$$
Which induces a jointly monic span, which we take to be the composite:

{\xymatrixrowsep{0mm}
$$
\xymatrix{
    & A \ar[dl]_{f} \ar[dr]^{g}
    &
  \\X 
    &
    & Y
};
\xymatrix{
    & B \ar[dl]_{f} \ar[dr]^{g}
    &
  \\Y 
    &
    & Z
}
:=
\xymatrix{
    &E  \ar[dl]_{m;\pi_0} \ar[dr]^{m;\pi_1}
    &
  \\X 
    &
    & Y
}
$$
}
The identity for composition is the same as for spans.
\item[2-cells:] The 2-cells are the same as for spans.
\end{description}
\end{definition}
Relations have the special property, unlike spans, that they are poset-enriched; that is to say, either there exists a single 2-cell between 1-cells or there doesn't. This makes things much simpler than the spans picture, because one never has to deal with coherence equations.  This also justifies the interpretation of nondeterministic processes in this setting: possibility amounts to the mere existence of a 2-cell.  Any two ways to arrive at the same result must be the same.


The is why, unlike for spans,  we don't have to quotient to obtain an ordinary category of relations we just need to forget about the 2-cells.

Just as for spans, relations are \dag-compact closed with respect to the Cartesian product where the \dag-functor is given by the converse.
Consider the following concrete example:
\begin{example}
$\Rel:=\Rel(\Set)$ has:
\begin{description}
\item[0-cells:] Natural numbers.
\item[1-cells:] A relation from $n\to m$ is a a subset $X \times Y$.
The composition of relations $R \subseteq X \times Y$  and $S \subseteq Y \times Z$ is given by:
$$
R;S := \{  (x,z) \in X\times Z: \exists y \in Y, (x,y) \in R \wedge (y,z) \in S \} \subseteq X\times Z
$$ 
\item[2-cells:] 
A 2-cell $R\Rightarrow S$ is a subset $R\subseteq S$.
\end{description}
\end{example}
If we restrict ourselves to finite sets we have the following well known equivalence.  The preservation and reflection of both monoidal structures is perhaps not so well-known; however, it is described in the infinite case in \cite[\S 3]{bruni}.
\begin{lemma}
$\Rel(\FSets)$ is symmetric monoidally equivalent to $\Mat(\B)$ under both tensor products. 
\end{lemma}
This quotient $\Span^{\sim}(\FSets)\twoheadrightarrow \Rel(\FSets)$ corresponds to applying the commutative semiring homorphism $\N\to \B$, where $\B$ is the Boolean semiring, making $2=1$.

Therefore the quotient from $\cb_\N\to\cb_\B$ can be stated as the following equation between string diagrams; meaning that we don't care which path we take, merely of the existence of a path:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (135) at (40, -0.25) {};
		\node [style=none] (136) at (40, -2.75) {};
		\node [style=X] (137) at (40, -1) {};
		\node [style=Z] (138) at (40, -2) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [bend right=45, looseness=1.25] (137) to (138);
		\draw [bend right=45, looseness=1.25] (138) to (137);
		\draw (135.center) to (137);
		\draw (136.center) to (138);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{special}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (135) at (40, -0.25) {};
		\node [style=none] (136) at (40, -2.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (135.center) to (136.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
%Notice how spans of finite sets are matrices over the natural numbers; whereas relations are matrices over the Boolean semiring.  This gives some concrete evidence for how the quotient going from spans to relations forgets about multiplicity.
%%
%%
%In the dual picture, corelations can be interpreted as the algebra for  partitions, and cospans as partitions with counting.  These interpretations are elucidated by looking at the monoidal presentations when these constructions are applied to finite sets.
%
%\begin{lemma} %GIVE DAGGERS
%Buni et als paper, separate into different lemmas
%
%
%Rel/Span under coproduct is monoidal.  Give presentation for finite sets, hint at the later connection to distributive laws
%  spans finite sets under the coproduct is strong monoidally isomorphic to natural number matrices under the direct sum
%  relations of finite sets under the coproduct is strong monoidally isomorphic to boolean matrices under the direct sum
%
%Rel/Span under product is monoidal.  Note that it is not a prop, so presenations are harder.  Hint at how we will take a shot at this in the ZXA section
%  spans finite sets under the product is strong monoidally isomorphic to natural number matrices under the bilinear tensor product
%  relations of finite sets under the product is strong monoidally isomorphic to boolean matrices under the bilinear tensor product
%
%
%CoRel/Cospan under coproduct is monoidal.  Give presentation for finite sets, hint at the later connection to distributive laws
%
%
%
%CoRel/Cospan under product is not monoidal.  It is only premonoidal.  Say this is an open problem.  Cite recent papers on premonoidal categories
%\end{lemma}
The following category of relations is very important for this thesis:
\begin{definition}
Given a field $k$, the $\dag$-compact closed prop of {\bf linear relations} over $k$, $\LinRel_{k}$ is defined to be $\Rel(\Mat_k)$ with respect to the direct sum.

Explicitly, $\LinRel_{k}$ has:
\begin{description}
\item[Objects:] Natural numbers.
\item[Maps:] A linear relation $n\to m$ is a linear subspace of $k^n \oplus k^m$.
\item[Composition:]  Given $R \subseteq k^n \oplus k^m$  and $S \subseteq k^m \oplus k^\ell$:
$$
R;S := \{  (x,z) \in k^{n} \oplus k^{\ell} : \exists y \in k^{m}, (x,y) \in R \wedge (y,z) \in S \} \subseteq k^n \oplus k^\ell
$$ 
\item[Tensor product:] Given $R \subseteq k^n \oplus k^m$ and $S \subseteq k^\ell \oplus k^q$:
$$R\oplus S : =
\left\{
\left(
\begin{pmatrix}
a_1\\a_2
\end{pmatrix},
\begin{pmatrix}
b_1\\b_2
\end{pmatrix}
:
\forall (a_1,b_1) \in R, (a_2,b_2) \in S
\right)
\right\} \subseteq k^{n+\ell}\oplus k^{m+q}
$$
\end{description}
\end{definition}
This prop has a presentation in terms of interacting Hopf algebras:
\begin{definition}
\label{def:ih}
Given a field $k$, let $\ih_k$ be the quotient of the props $\cb_k+\cb_k^\op$, modulo the equations, for all $a \in k^*$ (where the generators of $\cb_k^\op$ are drawn as the vertically flipped generators of $\cb_k$):
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0.75, 0.5) {};
		\node [style=Z] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (-0.25, 0) {};
		\node [style=none] (8) at (0.75, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1) to (2.center);
		\draw [in=90, out=-120] (1) to (7.center);
		\draw (0) to (1);
		\draw [in=-90, out=60] (0) to (6.center);
		\draw (8.center) to (0);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{frobl}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (98) at (50.75, 0) {};
		\node [style=none] (99) at (51.75, 0) {};
		\node [style=Z] (101) at (51.25, 0.5) {};
		\node [style=none] (102) at (50.75, 1.5) {};
		\node [style=none] (103) at (51.75, 1.5) {};
		\node [style=Z] (104) at (51.25, 1) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=90, out=-165, looseness=0.75] (101) to (98.center);
		\draw [in=-15, out=90, looseness=0.75] (99.center) to (101);
		\draw [in=-90, out=165, looseness=0.75] (104) to (102.center);
		\draw [in=15, out=-90, looseness=0.75] (103.center) to (104);
		\draw (101) to (104);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{frobr}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (17) at (4.5, 0.5) {};
		\node [style=Z] (18) at (5.25, 1) {};
		\node [style=none] (19) at (5.25, 1.5) {};
		\node [style=none] (20) at (4.25, 1.5) {};
		\node [style=none] (21) at (5.5, 0) {};
		\node [style=none] (22) at (4.5, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (18) to (19.center);
		\draw [in=90, out=-60] (18) to (21.center);
		\draw (17) to (18);
		\draw [in=-90, out=120] (17) to (20.center);
		\draw (22.center) to (17);
	\end{pgfonlayer}
\end{tikzpicture},
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 0) {};
		\node [style=Z] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (3) at (0, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (3.center);
		\draw [bend left=45, looseness=1.25] (0) to (1);
		\draw [bend left=45, looseness=1.25] (1) to (0);
		\draw (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{special}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (1, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (7.center) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture},
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (0) at (0.75, 0.5) {};
		\node [style=X] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (-0.25, 0) {};
		\node [style=none] (8) at (0.75, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1) to (2.center);
		\draw [in=90, out=-120] (1) to (7.center);
		\draw (0) to (1);
		\draw [in=-90, out=60] (0) to (6.center);
		\draw (8.center) to (0);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{frobl}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (98) at (50.75, 0) {};
		\node [style=none] (99) at (51.75, 0) {};
		\node [style=X] (101) at (51.25, 0.5) {};
		\node [style=none] (102) at (50.75, 1.5) {};
		\node [style=none] (103) at (51.75, 1.5) {};
		\node [style=X] (104) at (51.25, 1) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=90, out=-165, looseness=0.75] (101) to (98.center);
		\draw [in=-15, out=90, looseness=0.75] (99.center) to (101);
		\draw [in=-90, out=165, looseness=0.75] (104) to (102.center);
		\draw [in=15, out=-90, looseness=0.75] (103.center) to (104);
		\draw (101) to (104);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{frobr}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (17) at (4.5, 0.5) {};
		\node [style=X] (18) at (5.25, 1) {};
		\node [style=none] (19) at (5.25, 1.5) {};
		\node [style=none] (20) at (4.25, 1.5) {};
		\node [style=none] (21) at (5.5, 0) {};
		\node [style=none] (22) at (4.5, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (18) to (19.center);
		\draw [in=90, out=-60] (18) to (21.center);
		\draw (17) to (18);
		\draw [in=-90, out=120] (17) to (20.center);
		\draw (22.center) to (17);
	\end{pgfonlayer}
\end{tikzpicture},
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (0) at (0, 0) {};
		\node [style=X] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (3) at (0, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (3.center);
		\draw [bend left=45, looseness=1.25] (0) to (1);
		\draw [bend left=45, looseness=1.25] (1) to (0);
		\draw (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{special}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (1, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (7.center) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (11) at (3.75, -1) {};
		\node [style=Z] (12) at (3.75, -0.25) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (11) to (12);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{extra}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (2, 0) {};
		\node [style=none] (1) at (2, -1) {};
		\node [style=none] (2) at (3, -1) {};
		\node [style=none] (3) at (3, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw[style=dashed] (3.center) to (0.center) to (1.center) to (2.center) to cycle;
	\end{pgfonlayer}
\end{tikzpicture}
\eref{extra}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (11) at (3.75, -1) {};
		\node [style=X] (12) at (3.75, -0.25) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (11) to (12);
	\end{pgfonlayer}
\end{tikzpicture}
,
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (3) at (17, 1.5) {};
		\node [style=none] (4) at (17, -0.75) {};
		\node [style=scalarop] (5) at (17, 0.75) {$a$};
		\node [style=scalar] (6) at (17, 0) {$a$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (4.center) to (6);
		\draw (6) to (5);
		\draw (5) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (3) at (17, 1.5) {};
		\node [style=none] (4) at (17, -0.75) {};
		\node [style=scalar] (5) at (17, 0.75) {$a$};
		\node [style=scalarop] (6) at (17, 0) {$a$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (4.center) to (6);
		\draw (6) to (5);
		\draw (5) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (3) at (17, 1.5) {};
		\node [style=none] (4) at (17, -0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (4.center) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
\end{definition}
\begin{lemma}[{\cite[\S 3.4]{ih}}]
\label{lem:ih}
$\ih_k$ is a presentation for $\LinRel_{k}$.
\end{lemma}
The colour-swapping dagger functor $(-)^T:\ih_k^\op\to \ih_k$ corresponds to the transpose of matrices; and the colour-preserving dagger functor  $(-)^*:\ih_k^\op\to \ih_k$ corresponds transpose coming from the compact closed structure of $\ih_k$.  These should not be confused with each other: the latter is the relational converse.  
Combining these two daggers we have:
\begin{lemma}[{\cite{ortho}}]
\label{lem:ortho}
The orthogonal complement corresponds to the identity on objects involutive conjugation functor $(-)^\perp:\ih_k\to \ih_k;$
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (17) at (2.5, 0.5) {};
		\node [style=none] (18) at (3.5, 0.5) {};
		\node [style=Z] (19) at (3, 1.25) {};
		\node [style=none] (20) at (3, 0.75) {$\cdots$};
		\node [style=none] (21) at (3, 1.75) {$\cdots$};
		\node [style=none] (22) at (3.5, 2) {};
		\node [style=none] (23) at (3, 1.25) {};
		\node [style=none] (24) at (2.5, 2) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-56, out=90] (18.center) to (19);
		\draw [style=simple, in=90, out=-124] (19) to (17.center);
		\draw [style=simple, in=56, out=-90] (22.center) to (23.center);
		\draw [style=simple, in=-90, out=124] (23.center) to (24.center);
	\end{pgfonlayer}
\end{tikzpicture}
\mapsto 
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (17) at (2.5, 0.5) {};
		\node [style=none] (18) at (3.5, 0.5) {};
		\node [style=X] (19) at (3, 1.25) {};
		\node [style=none] (20) at (3, 0.75) {$\cdots$};
		\node [style=none] (21) at (3, 1.75) {$\cdots$};
		\node [style=none] (22) at (3.5, 2) {};
		\node [style=none] (23) at (3, 1.25) {};
		\node [style=none] (24) at (2.5, 2) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-56, out=90] (18.center) to (19);
		\draw [style=simple, in=90, out=-124] (19) to (17.center);
		\draw [style=simple, in=56, out=-90] (22.center) to (23.center);
		\draw [style=simple, in=-90, out=124] (23.center) to (24.center);
	\end{pgfonlayer}
\end{tikzpicture}\ , \hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (17) at (2.5, 0.5) {};
		\node [style=none] (18) at (3.5, 0.5) {};
		\node [style=X] (19) at (3, 1.25) {};
		\node [style=none] (20) at (3, 0.75) {$\cdots$};
		\node [style=none] (21) at (3, 1.75) {$\cdots$};
		\node [style=none] (22) at (3.5, 2) {};
		\node [style=none] (23) at (3, 1.25) {};
		\node [style=none] (24) at (2.5, 2) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-56, out=90] (18.center) to (19);
		\draw [style=simple, in=90, out=-124] (19) to (17.center);
		\draw [style=simple, in=56, out=-90] (22.center) to (23.center);
		\draw [style=simple, in=-90, out=124] (23.center) to (24.center);
	\end{pgfonlayer}
\end{tikzpicture}
\mapsto 
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (17) at (2.5, 0.5) {};
		\node [style=none] (18) at (3.5, 0.5) {};
		\node [style=Z] (19) at (3, 1.25) {};
		\node [style=none] (20) at (3, 0.75) {$\cdots$};
		\node [style=none] (21) at (3, 1.75) {$\cdots$};
		\node [style=none] (22) at (3.5, 2) {};
		\node [style=none] (23) at (3, 1.25) {};
		\node [style=none] (24) at (2.5, 2) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-56, out=90] (18.center) to (19);
		\draw [style=simple, in=90, out=-124] (19) to (17.center);
		\draw [style=simple, in=56, out=-90] (22.center) to (23.center);
		\draw [style=simple, in=-90, out=124] (23.center) to (24.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ , \hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=scalar] (54) at (15, -2.5) {$a$};
		\node [style=none] (55) at (15, -2) {};
		\node [style=none] (56) at (15, -3) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (56.center) to (54);
		\draw (54) to (55.center);
	\end{pgfonlayer}
\end{tikzpicture}
\mapsto 
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=scalarop] (54) at (15, -2.5) {$a$};
		\node [style=none] (55) at (15, -2) {};
		\node [style=none] (56) at (15, -3) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (56.center) to (54);
		\draw (54) to (55.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
\end{lemma}
From this, there is a graphical proof of the rank-nullity theorem:
\begin{lemma}[{\cite{ortho}}]
\label{lem:ker}
Given a matrix $A:n\to m$ in $\cb_k\hookrightarrow \ih_k$, then:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (3) at (21, 6) {$\im A$};
		\node [style=none] (5) at (21, 7) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (3) to (5.center);
	\end{pgfonlayer}
\end{tikzpicture}
:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (20, 6) {$A$};
		\node [style=Z] (1) at (20, 5) {};
		\node [style=none] (2) at (20, 7) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1) to (0);
		\draw (0) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
Therefore
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (3) at (21, 6) {$(\im A)^\perp$};
		\node [style=none] (5) at (21, 7) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (3) to (5.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (20, 6) {$(A^T)^*$};
		\node [style=X] (1) at (20, 5) {};
		\node [style=none] (2) at (20, 7) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1) to (0);
		\draw (0) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (3) at (21, 6) {$\ker (A^T)$};
		\node [style=none] (5) at (21, 7) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (3) to (5.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
\end{lemma}
The previous two results are almost certainly contained in \cite{ih} because of the importance of images and kernels in the proof that $\ih_k\cong \LinRel_k$, but they are hidden within calculations.

One might seek to find a similar presentation for relations internal to affine matrices.
However, the category $\Aff\Mat_k$ is not a regular category, it doesn't even have all pullbacks.
The empty set can not be regarded as a vector space because it has no origin; however, because affine transformations are not required to preserve the origin, it is perfectly fine to ask for an affine transformation from an empty space.


By shifting to the category $\Aff\Mat_k+1$ where one freely adds the empty set as the initial object, so that there is a unique map $\emptyset \xrightarrow{?_n} k^n$ for all $n$,  we obtain an algebraic theory, and thus a regular category.  Notice that $\Aff\Mat_k$ is the full subcategory of $\Aff\Mat_k+1$ with nonempty objects.  Therefore, we can take the category of internal relations:
\begin{definition}
\label{def:affrel}
The prop of {\bf affine relations} over $k$, $\Aff\Rel_{k}$ is the full subcategory of  $\Rel(\Aff\Mat_k+1)$ of nonempty affine subspaces.
\end{definition}
Concretely, this is constructed in the same way as $\LinRel_k$, but maps $n\to m$ are now (possibly empty) affine subspaces $S \subseteq k^n\oplus k^m$. That is to say, $S$ is a subset of $k^n\oplus k^m$ such that for any $a \in S$, the set $\{v+a\ |\ \forall v \in S\}$ is a linear subspace of  $k^n\oplus k^m$.  The empty set vacuously satisfies this condition.


We chose to forget the empty set as an object and retain it merely as a subobject so that we can present it as a (single sorted) prop as follows:
\begin{lemma}[{\cite[\S A]{affine}}]
\label{lem:affrel}
$\Aff\Rel_{k}$ is presented by the prop $\aih_k$ given by adding the following generators and equations to the presentation of $\ih_k$:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (0) at (0, -0.25) {$1$};
		\node [style=Z] (1) at (0, 0.5) {};
		\node [style=none] (2) at (-0.5, 1.25) {};
		\node [style=none] (3) at (0.5, 1.25) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (1);
		\draw [in=-90, out=150] (1) to (2.center);
		\draw [in=-90, out=30] (1) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
\erefop{bi.two}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (4) at (1.5, -0.25) {$1$};
		\node [style=none] (6) at (1.5, 1.25) {};
		\node [style=none] (7) at (2.5, 1.25) {};
		\node [style=X] (8) at (2.5, -0.25) {$1$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (4) to (6.center);
		\draw (7.center) to (8);
	\end{pgfonlayer}
\end{tikzpicture},
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (9) at (4, -0.25) {$1$};
		\node [style=Z] (10) at (4, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (9) to (10);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{extra}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (2, 0) {};
		\node [style=none] (1) at (2, -1) {};
		\node [style=none] (2) at (3, -1) {};
		\node [style=none] (3) at (3, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw[style=dashed] (3.center) to (0.center) to (1.center) to (2.center) to cycle;
	\end{pgfonlayer}
\end{tikzpicture}
\hspace*{.5cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (17) at (7.75, -0.25) {$1$};
		\node [style=X] (18) at (7.75, 0.5) {};
		\node [style=none] (19) at (8.5, 1) {};
		\node [style=none] (20) at (8.5, -0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (17) to (18);
		\draw (20.center) to (19.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eqzxa{zeroscalar}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=X] (21) at (9.25, -0.25) {$1$};
		\node [style=X] (22) at (9.25, 0.5) {};
		\node [style=none] (23) at (10, 1) {};
		\node [style=none] (24) at (10, -0.75) {};
		\node [style=X] (25) at (10, -0.25) {};
		\node [style=X] (26) at (10, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (21) to (22);
		\draw (24.center) to (25);
		\draw (26) to (23.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
\end{lemma}
The first two equations come from the presentation of affine matrices, and the last equation enforces the initiality of the affine space as a subobject.


The original presentation of $\Aff\Rel_k$ was proven to be equivalent to the concrete category of affine relations; rather than the nonempty full subcategory of internal relations of possibly empty, finite dimensional  affine spaces.  However, as we have discussed, both perspectives are equivalent.


The essence of the Cartesian monoidal structure of categories of relations can be generalised to the following algebraic notion due to \cite{carboni}:
\begin{definition}
\label{def:cartbicat}
A {\bf Cartesian bicategory of relations} is a symmetric monoidal category $\X$ enriched in posets,  equipped with a commutative Frobenius algebra $\zcirc$ on every object  (see Example \ref{ex:frob}), compatible with the monoidal structure:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (0, 2.5) {};
		\node [style=none] (1) at (1, 2.5) {};
		\node [style=Z] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
		\draw [style=simple, in=-90, out=117] (2) to (0.center);
		\draw [style=simple, in=63, out=-90] (1.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 2.5) {};
		\node [style=Z] (1) at (1, 2.5) {};
		\node [style=none] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
		\node [style=none] (4) at (0, 3.5) {};
		\node [style=none] (5) at (1, 3.5) {};
		\node [style=none] (6) at (0, 4.5) {};
		\node [style=none] (7) at (1, 4.5) {};
		\node [style=otimes] (8) at (0.5, 1.5) {};
		\node [style=otimes] (9) at (1, 3.5) {};
		\node [style=otimes] (10) at (0, 3.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2.center);
		\draw [style=simple, in=-90, out=135] (2.center) to (0);
		\draw [style=simple] (0) to (5.center);
		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
		\draw [style=simple] (1) to (4.center);
		\draw [style=simple, in=45, out=-90] (1) to (2.center);
		\draw [style=simple] (4.center) to (6.center);
		\draw [style=simple] (5.center) to (7.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (2) at (1, 1.5) {};
		\node [style=none] (3) at (1, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (4) at (2.5, 2.5) {};
		\node [style=Z] (5) at (3.5, 2.5) {};
		\node [style=none] (6) at (3, 1.5) {};
		\node [style=none] (7) at (3, 0.5) {};
		\node [style=otimes] (12) at (3, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (7.center) to (6.center);
		\draw [style=simple, in=-90, out=135] (6.center) to (4);
		\draw [style=simple, in=45, out=-90] (5) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}[yscale=-1]
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (0, 2.5) {};
		\node [style=none] (1) at (1, 2.5) {};
		\node [style=Z] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
		\draw [style=simple, in=-90, out=117] (2) to (0.center);
		\draw [style=simple, in=63, out=-90] (1.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}[yscale=-1]
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 2.5) {};
		\node [style=Z] (1) at (1, 2.5) {};
		\node [style=none] (2) at (0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.5) {};
		\node [style=none] (4) at (0, 3.5) {};
		\node [style=none] (5) at (1, 3.5) {};
		\node [style=none] (6) at (0, 4.5) {};
		\node [style=none] (7) at (1, 4.5) {};
		\node [style=otimes] (8) at (0.5, 1.5) {};
		\node [style=otimes] (9) at (1, 3.5) {};
		\node [style=otimes] (10) at (0, 3.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2.center);
		\draw [style=simple, in=-90, out=135] (2.center) to (0);
		\draw [style=simple] (0) to (5.center);
		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
		\draw [style=simple] (1) to (4.center);
		\draw [style=simple, in=45, out=-90] (1) to (2.center);
		\draw [style=simple] (4.center) to (6.center);
		\draw [style=simple] (5.center) to (7.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}[yscale=-1]
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (2) at (1, 1.5) {};
		\node [style=none] (3) at (1, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (3.center) to (2);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}[yscale=-1]
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (4) at (2.5, 2.5) {};
		\node [style=Z] (5) at (3.5, 2.5) {};
		\node [style=none] (6) at (3, 1.5) {};
		\node [style=none] (7) at (3, 0.5) {};
		\node [style=otimes] (12) at (3, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple] (7.center) to (6.center);
		\draw [style=simple, in=-90, out=135] (6.center) to (4);
		\draw [style=simple, in=45, out=-90] (5) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
%$$
%\begin{tikzpicture}[xscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (9) at (7.25, -1.5) {};
%		\node [style=none] (11) at (7.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (11.center) to (9.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitr}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{assoc}
%\begin{tikzpicture}[scale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{comm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
The (co)multiplications and  (co)units are moreover required to be lax-natural so that for any map $f$:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (12) at (2, 0) {};
		\node [style=none] (15) at (2.5, 0.75) {};
		\node [style=none] (17) at (2, -0.75) {};
		\node [style=none] (18) at (1.5, 0.75) {};
		\node [style=map] (19) at (2, -0.75) {$f$};
		\node [style=none] (20) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (17.center) to (12);
		\draw [in=-90, out=30] (12) to (15.center);
		\draw [in=150, out=-90] (18.center) to (12);
		\draw (20.center) to (17.center);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (3.75, -0.75) {};
		\node [style=none] (22) at (4.25, 0) {};
		\node [style=none] (23) at (3.75, -1.5) {};
		\node [style=none] (24) at (3.25, 0) {};
		\node [style=map] (25) at (3.25, 0) {$f$};
		\node [style=map] (27) at (4.25, 0) {$f$};
		\node [style=none] (28) at (3.25, 0.75) {};
		\node [style=none] (29) at (4.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (23.center) to (21);
		\draw [in=-90, out=30] (21) to (22.center);
		\draw [in=150, out=-90] (24.center) to (21);
		\draw (28.center) to (25);
		\draw (29.center) to (27);
	\end{pgfonlayer}
\end{tikzpicture} \ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (2, 0) {};
		\node [style=none] (2) at (2, -0.75) {};
		\node [style=map] (4) at (2, -0.75) {$f$};
		\node [style=none] (5) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (2.center) to (0);
		\draw (5.center) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (6) at (3.75, -0.75) {};
		\node [style=none] (8) at (3.75, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (8.center) to (6);
	\end{pgfonlayer}
\end{tikzpicture}
 \ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3.75, 0) {};
		\node [style=none] (1) at (4.25, -0.75) {};
		\node [style=none] (2) at (3.75, 0.75) {};
		\node [style=none] (3) at (3.25, -0.75) {};
		\node [style=map] (4) at (3.25, -0.75) {$f$};
		\node [style=map] (5) at (4.25, -0.75) {$f$};
		\node [style=none] (6) at (3.25, -1.5) {};
		\node [style=none] (7) at (4.25, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (2.center) to (0);
		\draw [in=90, out=-30] (0) to (1.center);
		\draw [in=-150, out=90] (3.center) to (0);
		\draw (6.center) to (4);
		\draw (7.center) to (5);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (8) at (5.75, -0.75) {};
		\node [style=none] (9) at (6.25, -1.5) {};
		\node [style=none] (10) at (5.75, 0) {};
		\node [style=none] (11) at (5.25, -1.5) {};
		\node [style=map] (12) at (5.75, 0) {$f$};
		\node [style=none] (13) at (5.75, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (10.center) to (8);
		\draw [in=90, out=-30] (8) to (9.center);
		\draw [in=-150, out=90] (11.center) to (8);
		\draw (13.center) to (10.center);
	\end{pgfonlayer}
\end{tikzpicture}
 \ ,
\hspace*{.2cm}
\begin{tikzpicture}[yscale=-1]
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (6) at (3.75, -0.75) {};
		\node [style=none] (8) at (3.75, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (8.center) to (6);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (9) at (4.75, -1.5) {};
		\node [style=none] (10) at (4.75, -0.75) {};
		\node [style=map] (11) at (4.75, -0.75) {$f$};
		\node [style=none] (12) at (4.75, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (10.center) to (9);
		\draw (12.center) to (10.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
And the multiplications and units are required to be right adjoint to the comultiplications and counits:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (16) at (4.25, -1.5) {};
		\node [style=none] (17) at (3.25, -1.5) {};
		\node [style=none] (19) at (4.25, 0.75) {};
		\node [style=none] (20) at (3.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (16.center) to (19.center);
		\draw (20.center) to (17.center);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (8) at (5.75, -0.75) {};
		\node [style=none] (9) at (6.25, -1.5) {};
		\node [style=none] (11) at (5.25, -1.5) {};
		\node [style=Z] (12) at (5.75, 0) {};
		\node [style=none] (13) at (6.25, 0.75) {};
		\node [style=none] (14) at (5.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=90, out=-30] (8) to (9.center);
		\draw [in=-150, out=90] (11.center) to (8);
		\draw [in=-90, out=30] (12) to (13.center);
		\draw [in=150, out=-90] (14.center) to (12);
		\draw (8) to (12);
	\end{pgfonlayer}
\end{tikzpicture}
\ , \hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 0) {};
		\node [style=Z] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (3) at (0, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (3.center);
		\draw [bend left=45, looseness=1.25] (0) to (1);
		\draw [bend left=45, looseness=1.25] (1) to (0);
		\draw (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{special}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (1, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (7.center) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (27) at (8.25, -1.5) {};
		\node [style=none] (29) at (8.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (27.center) to (29.center);
	\end{pgfonlayer}
\end{tikzpicture}
\leq
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (10, -0.75) {};
		\node [style=none] (23) at (10, -1.5) {};
		\node [style=Z] (24) at (10, 0) {};
		\node [style=none] (26) at (10, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (23.center) to (21);
		\draw (26.center) to (24);
	\end{pgfonlayer}
\end{tikzpicture} \ , \hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (10, -0.75) {};
		\node [style=Z] (24) at (10, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (24) to (21);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{extra}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (2, 0) {};
		\node [style=none] (1) at (2, -1) {};
		\node [style=none] (2) at (3, -1) {};
		\node [style=none] (3) at (3, 0) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw[style=dashed] (3.center) to (0.center) to (1.center) to (2.center) to cycle;
	\end{pgfonlayer}
\end{tikzpicture}
$$
%
%And the monoids and comonoids are moreover required to form Frobenius algebras:
%
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0.75, 0.5) {};
%		\node [style=Z] (1) at (0, 1) {};
%		\node [style=none] (2) at (0, 1.5) {};
%		\node [style=none] (6) at (1, 1.5) {};
%		\node [style=none] (7) at (-0.25, 0) {};
%		\node [style=none] (8) at (0.75, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (1) to (2.center);
%		\draw [in=90, out=-120] (1) to (7.center);
%		\draw (0) to (1);
%		\draw [in=-90, out=60] (0) to (6.center);
%		\draw (8.center) to (0);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{frobl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (98) at (50.75, 0) {};
%		\node [style=none] (99) at (51.75, 0) {};
%		\node [style=Z] (101) at (51.25, 0.5) {};
%		\node [style=none] (102) at (50.75, 1.5) {};
%		\node [style=none] (103) at (51.75, 1.5) {};
%		\node [style=Z] (104) at (51.25, 1) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-165, looseness=0.75] (101) to (98.center);
%		\draw [in=-15, out=90, looseness=0.75] (99.center) to (101);
%		\draw [in=-90, out=165, looseness=0.75] (104) to (102.center);
%		\draw [in=15, out=-90, looseness=0.75] (103.center) to (104);
%		\draw (101) to (104);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{frobl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (17) at (4.5, 0.5) {};
%		\node [style=Z] (18) at (5.25, 1) {};
%		\node [style=none] (19) at (5.25, 1.5) {};
%		\node [style=none] (20) at (4.25, 1.5) {};
%		\node [style=none] (21) at (5.5, 0) {};
%		\node [style=none] (22) at (4.5, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (18) to (19.center);
%		\draw [in=90, out=-60] (18) to (21.center);
%		\draw (17) to (18);
%		\draw [in=-90, out=120] (17) to (20.center);
%		\draw (22.center) to (17);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%
%
%From these other axioms, it follows that:
%
%
%$$
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0, 2.5) {};
%		\node [style=none] (1) at (1, 2.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%		\draw [style=simple, in=-90, out=117] (2) to (0.center);
%		\draw [style=simple, in=63, out=-90] (1.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 2.5) {};
%		\node [style=Z] (1) at (1, 2.5) {};
%		\node [style=none] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%		\node [style=none] (4) at (0, 3.5) {};
%		\node [style=none] (5) at (1, 3.5) {};
%		\node [style=none] (6) at (0, 4.5) {};
%		\node [style=none] (7) at (1, 4.5) {};
%		\node [style=otimes] (8) at (0.5, 1.5) {};
%		\node [style=otimes] (9) at (1, 3.5) {};
%		\node [style=otimes] (10) at (0, 3.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2.center);
%		\draw [style=simple, in=-90, out=135] (2.center) to (0);
%		\draw [style=simple] (0) to (5.center);
%		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
%		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
%		\draw [style=simple] (1) to (4.center);
%		\draw [style=simple, in=45, out=-90] (1) to (2.center);
%		\draw [style=simple] (4.center) to (6.center);
%		\draw [style=simple] (5.center) to (7.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (2) at (1, 1.5) {};
%		\node [style=none] (3) at (1, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (4) at (2.5, 2.5) {};
%		\node [style=Z] (5) at (3.5, 2.5) {};
%		\node [style=none] (6) at (3, 1.5) {};
%		\node [style=none] (7) at (3, 0.5) {};
%		\node [style=otimes] (12) at (3, 1.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (7.center) to (6.center);
%		\draw [style=simple, in=-90, out=135] (6.center) to (4);
%		\draw [style=simple, in=45, out=-90] (5) to (6.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%$$
%\begin{tikzpicture}[scale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{unitl}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (9) at (7.25, -1.5) {};
%		\node [style=none] (11) at (7.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (11.center) to (9.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{unitr}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{assoc}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{comm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
\end{definition}
Therefore, now we can copy and delete things with the commutative comonoid structure in a partial, deterministic manner. Moreover the commutative monoid structure also allows us to  compare and ask for the existence of things in a nondeterministic and partial manner.


%Moreover, because Cartesian bicategories of relations are equipped with a chosen compatible family of Frobenius algebras, they are self-dual \dag-compact closed. For categories of internal relations, the \dag-structure is given by the transpose/relational converse.

Given a finitely complete category $\X$, $\Span(\X)$ is not a Cartesian bicategory of relations because it is not poset enriched (there can be more than one 2-cell between 1-cells); however it is a {\em Cartesian bicategory} (see \cite{carbonia}).  All of the equations now only hold up to coherent isomorphism, however the story is essentially the same. This is much more difficult to work with because this notion requires coherence conditions so we will omit this more general definition for the sake of brevity. 


Cartesian bicategories of relations subsume categories of internal relations:
\begin{example}
Given a regular category $\X$, $\Rel(\X)$ is a Cartesian bicategory of relations under the Cartesian product and $\Map(\Rel(\X))=\X$, where $\Map(\X)$ is the category of comonoid homorphisms in a Cartesian bicategory of relations $\X$.
\end{example}
We see that either the white and grey Frobenius algebras of the presentation $\ih_k$ of $\LinRel_k$ can be regarded as the Frobenius algebra structure coming from viewing it as a bicategory of relations.  Similarly, for the white Frobenius algebra of  $\Aff\Rel$, but {\em not} the grey one because addition and copying are no longer dual to each other.




There are classes of categories in between Cartesian categories and Cartesian bicategories of relations which capture partially invertible and partial deterministic notions of copying.  We review these notions and give examples which will serve to motivate their usage in quantum computing later in this thesis.



%Partial maps of sets are spans with left leg monic. Give span diagram with domain and function


First, we review the categorical semantics of partiality:
\label{sec:rest}
%Restriction and inverse categories provide a categorical semantics for partial computing and reversible computing, respectively.  We review how weakened products can be constructed in both settings; relating one to the other.
\begin{definition}\cite[\S 2.1.1]{cockett}
A {\bf restriction category} is a category along with a restriction operator 
$
(A \xrightarrow{f} B )\mapsto (A \xrightarrow{\bar f} A)
$
such that:\\

\noindent\hspace*{-.85cm}
\begingroup
\setlength{\columnsep}{-25pt}
\setlength{\parindent}{0pt}
\begin{minipage}{16cm}
\begin{multicols}{4}
\begin{enumerate}[label={\bf [R.\arabic*]}, ref={\bf [R.\arabic*]}, labelindent=0pt, itemsep=0pt]
\item $\bar f ; f  = f$
\label{R.1}
\item $\bar f ; \bar g = \bar g ; \bar f$
\label{R.2}
\item $\bar f ; \bar g = \bar{\bar f ;  g}$
\label{R.3}
\item $f ; \bar g = \bar{f; g} ; f$
\label{R.4}
\end{enumerate}
\end{multicols}
\end{minipage}
\endgroup\\

\noindent
Maps of the form $\bar f$ are called restriction idempotents.
Restriction categories are poset enriched where $f \leq g \iff \bar f ; g = f$.
A map $f$ in a restriction category is {\bf total} if $\bar f =1$.  Denote the subcategory of total maps of $\X$ by $\Total(\X)$.
A map $f$ in a restriction category is called a {\bf partial isomorphism}, in case there exists a {\bf partial inverse} $g$ of $f$ so that $f;g=\bar f$ and $g;f = \bar g$. Denote the category of partial isomorphisms of $\X$ by $\Inv(\X)$.
\end{definition}
\begin{example}
The category $\Par$ of sets and partial functions is a restriction category.   Given a partial map $f:X\to Y$, the restriction acts as the identity on the domain of definition:
$$
\bar f (x):=
\begin{cases}
x & \text{if }f(x)\text{ is defined}\\
\text{undefined} & \text{otherwise}
\end{cases}
$$
\end{example}
%
%One can augment partiality with copying:
%
%\begin{example} \cite[p. 101]{pcat} \cite[\S 5]{restiii}
%A {\bf counital copy category} (or a p-category with a one element object) is a monoidal category with a family of commutative comonoids on every object compatible with the monoidal structure, with a natural comultiplication.  This gives a restriction via copying and then discarding:
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0.75, -2.5) {};
%		\node [style=none] (1) at (0.75, -0.5) {};
%		\node [style=map] (2) at (0.75, -1.5) {$\bar f$};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (0.center) to (2);
%		\draw [style=simple] (2) to (1.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%:=
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=map] (0) at (0, 2.5) {$f$};
%		\node [style=Z] (1) at (0, 3.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (1, 3.5) {};
%		\node [style=none] (4) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (1) to (0);
%		\draw [style=simple, in=117, out=-90] (0) to (2);
%		\draw [style=simple] (2) to (4.center);
%		\draw [style=simple, in=-90, out=60] (2) to (3.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%\end{example}
To augment restriction categories with copying, one must relax the definition of a Cartesian category: 
\begin{definition}[{\cite{restiii}}]
A restriction category has {\bf binary restriction products}, when for all objects  $X$ and $Y$, there exists an object $X\times Y$ and total maps $X \xleftarrow{\pi_0}  X\times Y \xrightarrow{\pi_1} Y$, so that for all objects $Z$ and all maps $X \xleftarrow{f} Z \xrightarrow{g} Y$, there exists a unique $Z\xrightarrow{\langle f,g \rangle} X\times Y$ making the diagram commute:
$$
\xymatrixrowsep{0.2cm}
\xymatrixcolsep{0.4cm}
\xymatrix{
&& Z\ar@{..>}[dd]|-{\langle f, g\rangle} \ar@/_/[ddll]_f \ar@/^/[ddrr]^g &&\\
& \ar@{}[dr]|-{\geq} && \ar@{}[dl] |-{\leq} &\\
X &&  X\times Y \ar[rr]_{\pi_1} \ar[ll]^{\pi_0}  && Y
}
$$
so that $\bar{\langle f, g\rangle ;\pi_0}; f = \langle f, g\rangle ;\pi_0$ and $\bar{\langle f, g\rangle; \pi_1} ;g = \langle f, g\rangle; \pi_1$
where additionally $\bar{\langle f, g\rangle} =  \bar f ; \bar g$.

%%DRAW DIAGRAM
%\begin{center}
%\begin{tabular}{ccc}
%  $\langle f, g\rangle \pi_0 \leq f$ &
%  $\langle f, g\rangle \pi_1 \leq g$ &
%  $\bar{\langle f, g\rangle} =  \bar f \bar g$
%\end{tabular}
%\end{center}

A restriction category has a {\bf restriction terminal object} $\one$ when for all objects $X$, there exists a unique total map $!_X:X\to\one$ such that $f ; !_Y = \bar  f; !_X$.
A restriction category with a restriction terminal object and binary restriction products is a {\bf Cartesian restriction category}.
An object $X$ in a restriction category with restriction products is {\bf discrete} when the diagonal map $\Delta_X:=\langle 1_X, 1_X\rangle$ is a partial isomorphism. A restriction category is discrete when all objects are discrete. 
\end{definition}
\begin{example}
$\Par$ is a canonical example of a discrete Cartesian restriction category; the restriction product is given by the Cartesian product on underlying sets and the terminal object is  the singleton set.
\end{example}
\begin{theorem}[{\cite[Theorem 5.2]{restiii}}]
Cartesian restriction categories are in bijection with symmetric monoidal categories equipped with a supply of cocommutative comonoids $\zcirc$ compatible with the tensor product, so that the multiplication is natural:
%
%$$
%\begin{tikzpicture}[xscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (9) at (7.25, -1.5) {};
%		\node [style=none] (11) at (7.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (11.center) to (9.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{unitr}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (5.75, -0.75) {};
%		\node [style=none] (1) at (6.25, 0) {};
%		\node [style=none] (2) at (5.75, -1.5) {};
%		\node [style=none] (3) at (5.25, 0) {};
%		\node [style=none] (5) at (5.25, 0.75) {};
%		\node [style=Z] (6) at (6.25, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (2.center) to (0);
%		\draw [in=-90, out=30] (0) to (1.center);
%		\draw [in=150, out=-90] (3.center) to (0);
%		\draw [in=270, out=90] (3.center) to (5.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{assoc}
%\begin{tikzpicture}[scale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{comm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%Compatible with the monoidal structure:
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0, 2.5) {};
%		\node [style=none] (1) at (1, 2.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%		\draw [style=simple, in=-90, out=117] (2) to (0.center);
%		\draw [style=simple, in=63, out=-90] (1.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 2.5) {};
%		\node [style=Z] (1) at (1, 2.5) {};
%		\node [style=none] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%		\node [style=none] (4) at (0, 3.5) {};
%		\node [style=none] (5) at (1, 3.5) {};
%		\node [style=none] (6) at (0, 4.5) {};
%		\node [style=none] (7) at (1, 4.5) {};
%		\node [style=otimes] (8) at (0.5, 1.5) {};
%		\node [style=otimes] (9) at (1, 3.5) {};
%		\node [style=otimes] (10) at (0, 3.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2.center);
%		\draw [style=simple, in=-90, out=135] (2.center) to (0);
%		\draw [style=simple] (0) to (5.center);
%		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
%		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
%		\draw [style=simple] (1) to (4.center);
%		\draw [style=simple, in=45, out=-90] (1) to (2.center);
%		\draw [style=simple] (4.center) to (6.center);
%		\draw [style=simple] (5.center) to (7.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (2) at (1, 1.5) {};
%		\node [style=none] (3) at (1, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (4) at (2.5, 2.5) {};
%		\node [style=Z] (5) at (3.5, 2.5) {};
%		\node [style=none] (6) at (3, 1.5) {};
%		\node [style=none] (7) at (3, 0.5) {};
%		\node [style=otimes] (12) at (3, 1.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (7.center) to (6.center);
%		\draw [style=simple, in=-90, out=135] (6.center) to (4);
%		\draw [style=simple, in=45, out=-90] (5) to (6.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%
%
%Where the comultiplication is moreover required to be natural, so that:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (12) at (2, 0) {};
		\node [style=none] (15) at (2.5, 0.75) {};
		\node [style=none] (17) at (2, -0.75) {};
		\node [style=none] (18) at (1.5, 0.75) {};
		\node [style=map] (19) at (2, -0.75) {$f$};
		\node [style=none] (20) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (17.center) to (12);
		\draw [in=-90, out=30] (12) to (15.center);
		\draw [in=150, out=-90] (18.center) to (12);
		\draw (20.center) to (17.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (3.75, -0.75) {};
		\node [style=none] (22) at (4.25, 0) {};
		\node [style=none] (23) at (3.75, -1.5) {};
		\node [style=none] (24) at (3.25, 0) {};
		\node [style=map] (25) at (3.25, 0) {$f$};
		\node [style=map] (27) at (4.25, 0) {$f$};
		\node [style=none] (28) at (3.25, 0.75) {};
		\node [style=none] (29) at (4.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (23.center) to (21);
		\draw [in=-90, out=30] (21) to (22.center);
		\draw [in=150, out=-90] (24.center) to (21);
		\draw (28.center) to (25);
		\draw (29.center) to (27);
	\end{pgfonlayer}
\end{tikzpicture}
$$
The restriction is defined as follows:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (7) at (-1.75, 0.75) {$\bar f$};
		\node [style=none] (10) at (-1.75, 2) {};
		\node [style=none] (11) at (-1.75, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (11.center) to (7);
		\draw (7) to (10.center);
	\end{pgfonlayer}
\end{tikzpicture}
:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 0) {};
		\node [style=map] (1) at (-0.5, 0.75) {$f$};
		\node [style=Z] (2) at (-0.5, 1.5) {};
		\node [style=none] (3) at (0.5, 0.75) {};
		\node [style=none] (4) at (0.5, 1.75) {};
		\node [style=none] (5) at (0, -0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (5.center) to (0);
		\draw [in=-90, out=150] (0) to (1);
		\draw (1) to (2);
		\draw [in=-90, out=30] (0) to (3.center);
		\draw (3.center) to (4.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
This correspondence restricts to discrete Cartesian restriction categories when the multiplications have retracts $\zcirc$:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (0, 0) {};
		\node [style=Z] (1) at (0, 1) {};
		\node [style=none] (2) at (0, 1.5) {};
		\node [style=none] (3) at (0, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (3.center);
		\draw [bend left=45, looseness=1.25] (0) to (1);
		\draw [bend left=45, looseness=1.25] (1) to (0);
		\draw (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eref{special}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (6) at (1, 1.5) {};
		\node [style=none] (7) at (1, -0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (7.center) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
Which implies that these retracts are commutative  semigroups, interacting with the multiplication to form non-unital Frobenius algebras.
%
% have retracts to the diagonal maps, which is are cocommutative due to the commutativity of the diagonal map:
%
%$$
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0, 2.5) {};
%		\node [style=none] (1) at (1, 2.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%		\draw [style=simple, in=-90, out=117] (2) to (0.center);
%		\draw [style=simple, in=63, out=-90] (1.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 2.5) {};
%		\node [style=Z] (1) at (1, 2.5) {};
%		\node [style=none] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%		\node [style=none] (4) at (0, 3.5) {};
%		\node [style=none] (5) at (1, 3.5) {};
%		\node [style=none] (6) at (0, 4.5) {};
%		\node [style=none] (7) at (1, 4.5) {};
%		\node [style=otimes] (8) at (0.5, 1.5) {};
%		\node [style=otimes] (9) at (1, 3.5) {};
%		\node [style=otimes] (10) at (0, 3.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2.center);
%		\draw [style=simple, in=-90, out=135] (2.center) to (0);
%		\draw [style=simple] (0) to (5.center);
%		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
%		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
%		\draw [style=simple] (1) to (4.center);
%		\draw [style=simple, in=45, out=-90] (1) to (2.center);
%		\draw [style=simple] (4.center) to (6.center);
%		\draw [style=simple] (5.center) to (7.center);
%	\end{pgfonlayer}
%\end{tikzpicture}\ ,
%\hspace{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 0) {};
%		\node [style=Z] (1) at (0, 1) {};
%		\node [style=none] (2) at (0, 1.5) {};
%		\node [style=none] (3) at (0, -0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (0) to (3.center);
%		\draw [bend left=45, looseness=1.25] (0) to (1);
%		\draw [bend left=45, looseness=1.25] (1) to (0);
%		\draw (1) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{special}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (6) at (1, 1.5) {};
%		\node [style=none] (7) at (1, -0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (7.center) to (6.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{assoc}
%\begin{tikzpicture}[xscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{comm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%
%And is which moreover, interacts to form a semi-Frobenius algebra with the diagonal map due to the naturality of the diagonal map:
%
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0.75, 0.5) {};
%		\node [style=Z] (1) at (0, 1) {};
%		\node [style=none] (2) at (0, 1.5) {};
%		\node [style=none] (6) at (1, 1.5) {};
%		\node [style=none] (7) at (-0.25, 0) {};
%		\node [style=none] (8) at (0.75, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (1) to (2.center);
%		\draw [in=90, out=-120] (1) to (7.center);
%		\draw (0) to (1);
%		\draw [in=-90, out=60] (0) to (6.center);
%		\draw (8.center) to (0);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{frobl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (98) at (50.75, 0) {};
%		\node [style=none] (99) at (51.75, 0) {};
%		\node [style=Z] (101) at (51.25, 0.5) {};
%		\node [style=none] (102) at (50.75, 1.5) {};
%		\node [style=none] (103) at (51.75, 1.5) {};
%		\node [style=Z] (104) at (51.25, 1) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-165, looseness=0.75] (101) to (98.center);
%		\draw [in=-15, out=90, looseness=0.75] (99.center) to (101);
%		\draw [in=-90, out=165, looseness=0.75] (104) to (102.center);
%		\draw [in=15, out=-90, looseness=0.75] (103.center) to (104);
%		\draw (101) to (104);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{frobr}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (17) at (4.5, 0.5) {};
%		\node [style=Z] (18) at (5.25, 1) {};
%		\node [style=none] (19) at (5.25, 1.5) {};
%		\node [style=none] (20) at (4.25, 1.5) {};
%		\node [style=none] (21) at (5.5, 0) {};
%		\node [style=none] (22) at (4.5, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (18) to (19.center);
%		\draw [in=90, out=-60] (18) to (21.center);
%		\draw (17) to (18);
%		\draw [in=-90, out=120] (17) to (20.center);
%		\draw (22.center) to (17);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%
\end{theorem}
We recall the following definition of \cite[\S 3]{cockett}, which was originally stated in the more general setting of categories with stable systems of monics, rather than finitely complete categories:
\begin{definition}
\label{def:par}
Given a finitely complete category $\X$,  there is a discrete Cartesian restriction category, the {\bf category of partial maps}, $\Par(\X)$ is generated by spans $(m,A,f)$, for $m$ a monic and $f$ and arbitrary map, i.e. spans of the form
$
\xymatrix{
X 
&
\ A \ar@{>->}[l]_m \ar[r]^{f}
&
Y
}
$.

 $\Par(\X)$ is a discrete Cartesian restriction category where the natural monoid structure is given by spans of the form 
$
\xymatrix{
X 
&
X \ \ar@{=}[l] \ar@{>->}[r]^{\Delta_X \ \ \ }
&
X\times X
}
$.


Its partial inverse is given by the span  
$
\xymatrix{
X \times X
&
X \ \ar@{=}[r] \ar@{>->}[l]_{\ \ \ \Delta_X}
&
X
}
$.

And the counit is given by 
$
\xymatrix{
X 
&
X \ar@{=}[l] \ar@{->>}[r]^{!_X}
&
\one
}
$.
\end{definition}
The basic idea is that the left leg picks out the domain of definition.  
Unrolling the definition, we see that a map
$
\xymatrix{
X 
&
\ A  \ar@{>->}[l]_m \ar[r]^{f}
&
Y
}
$ 
has a partial inverse precisely when $f$ is a monomorphism; moreover, the restriction idempotents are spans where both legs are the same monomorphism:
$
\xymatrix{
X 
&
\ A\  \ar@{>->}[l]_m \ar@{>->}[r]^{m}
&
Y
}
$.
This agrees with our running example of a a restriction category:
\begin{example}
$\Par\cong\Par(\Set)$
\end{example}
Full subcategories of $\Par$ are also restriction categories.  Therefore, in such a setting the domain of definition need not be an actual object in the category of partial maps.  In such a case the restriction idempotent $X\xrightarrow{e}X$ is regarded as a {\bf subobject} of $X$.  Despite not properly being an object, $e$ is morally one.  We discuss how subobjects can be promoted to objects in Definition \ref{def:idem}.


Cartesian restriction categories are the partial version of Cartesian categories:
\begin{lemma} 
\label{prop:cartesian}
If $\X$ is a  Cartesian restriction category, the  $\Total(\X)$ is Cartesian.
\end{lemma}
\begin{proof}
By definition, the total maps in a Cartesian restriction category are those which are natural with respect to the counits. Moreover, all maps are already natural with respect to the diagonal maps.
\end{proof}
%
%
%
%There is a way to construct restriction categories in terms of a category of spans where the left leg is a monomorphism:
%\begin{definition}[{\cite[\S 3.1]{cockett}}]
%Given a category $\X$ with finite limits,  the {\bf partial map category} $\Par(\X)$ is the strict 2-category with:
%
%\begin{description}
%\item[0-cells:] are objects in $\X$
%
%\item[1-cells:]  A $1$-cell  $(A,m,f):X\toY$ is a span:
%
%
%$$
%\xymatrix{
%    & A \ar@{>->}[dl]_{m} \ar[dr]^{f}
%    &
%  \\X 
%    &
%    & Y
%}
%$$
%
%Where $m$ is a monomorphism.  The composition and identity is the same as spans.
%
%\item[2-cells:] The 2-cell structure is the same as spans.
%\end{description}
%
%Just as for internal relations,  the 2-cells are monics so that $\Par(\X)$ is poset enriched; and it can be treated as an ordinary category by forgetting the 2-cell structure.
%
%
%Partial map categories have a restriction structure given by:  
%$$(X\xleftarrowtail{m} \ Z \xrightarrow{f} Y) \mapsto (X\xleftarrowtail{m} \ Z\ \xrightarrowtail{m} X)$$  Moreover, a partial isomorphism is a span $X\xleftarrowtail{e}\ Z\  \xrightarrowtail{m} Y$ where $e,m \in \M$; the partial inverse given by  $Y\xleftarrowtail{m} \ Z  \ \xrightarrowtail{e} X$.
%
%The idea is that the apex is the domain of definition the partial map; with the monomorphism picking the domain of definition out of the domain.
%\end{definition}
%
%Note that in the cited reference $\X$ is not required to be complete; rather, they ask for the left legs to belong to a class of monorphisms containing all isomorphisms and closed under pullback.
%
%
%
%\begin{example}
%$\Par(\Set) = \Par$.
%\end{example}
%
%
Similarly, discrete Cartesian restriction categories are a deterministic, yet partial version of relations:
\begin{lemma}
The category of comultiplication homorphisms of a Cartesian bicategory of relations is a discrete Cartesian restriction category.
\end{lemma}
Let us refine the notion of a restriction category:
\begin{definition}[{\cite[\S 2.3.2]{cockett}}]
An {\bf inverse category} is a restriction category in which all maps are partial isomorphisms.
\end{definition}
\begin{example}
$\Inv(\Par)\cong\Pinj$
\end{example}
Inverse categories are particular kinds of \dag-categories:
\begin{theorem}[{\cite[Theorem 2.20]{cockett}}]
A restriction category $\X$ is an inverse category if and only if there is a dagger functor $(-)^\circ:\X^\op\to\X$ such that for all $X\xleftarrow{f} Z \xrightarrow{g} Y$:

\noindent
%\setlength{\columnsep}{0pt}
\begin{minipage}{14cm}
\begin{multicols}{2}
\begin{enumerate}[label={\bf [INV.\arabic*]}, ref={\bf [INV.\arabic*]}, labelindent=0pt, itemsep=0pt]
\item $f; f^\circ ; f = f$
\label{INV.1}
\item $f ; f ^\circ ;g; g^\circ = g;g^\circ ; f; f ^\circ $
\label{INV.2}
\end{enumerate}
\end{multicols}
\end{minipage}

\end{theorem}
The dagger functor takes maps to their partial inverse.
In particular, the unitary maps in an inverse category are the total maps.


Sets and partial injections are intimately related to Hilbert spaces.  The following functor was first discovered by \cite{barr}; later studied in much more detail in \cite{elltwo}:
\begin{definition}
\label{def:elltwo}
There is a \dag-symmetric monoidal embedding $\ell^2:\Pinj\to\Hilb$ taking:
\begin{description}
\item[Objects:] Sets $X$ are taken to the Hilbert space of square-summable functions on $X$:
$$
\ell^2(X):=\left\{\phi:X\to \C  \ \bigl\vert \sum_{x\in X} \ \left|\phi(x)\right|^2 < \infty \right\}
$$
\item[Maps:] Given a partial injection $f=X \xleftarrowtail{f_0} \ A \  \xrightarrowtail{f_1} Z$ and some $\phi:X\to \C$ in $\ell^2(X)$:
$$
(\ell^2(f)(\phi))(y) = \sum_{x\in f_1^{-1}(y)} \phi(f_0(x))
$$ 
\end{description}
The partial inverse is mapped to the Hermitian adjoint.

In particular, $\ell^2(X)$ has a distinguished orthonormal basis given by 
$$\{\delta_{x}:X\to \C\ | \ \forall x \in X \}$$
where $\delta_x$ is the Dirac delta at $X$:
$$
\delta_x(y) \mapsto
\begin{cases}
1 & \text{if } $x=y$\\
0 & \text{otherwise}
\end{cases}
$$
\end{definition}
The category of partial injections is unusual in the sense that it embeds into $\Hilb$. This does not generalize to spans between sets, for example: the maps are no longer sent to bounded linear maps.
However, if the domain is changed to the category of spans of {\em finite} sets this induces an embedding into $\FHilb$.  This is actually the version we will use throughout this thesis, but we give the general definition to highlight the importance of inverse categories in the categorical semantics of quantum mechanics.


We also have a deterministic partially invertible notion of copying:
\begin{definition}[{\cite[Definition 4.3.1]{giles}}]
A symmetric monoidal inverse category $\X$ is a {\bf discrete inverse category} when it is a dagger symmetric monoidal  category, equipped with a commutative multiplication and cocommutative comulitplication $\zcirc$ which are daggers of each other and interact via the special Frobenius laws which are natural so that:
%equipped commutative semigroup and cocommutative cosemigroup on every object which are daggers of each other, interacting to form special commutative Frobenius algebras; which are moreover natural
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{assoc}
%\begin{tikzpicture}[xscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{comm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{assoc}
%\begin{tikzpicture}[scale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (12, 2) {};
%		\node [style=none] (1) at (12.5, 1.25) {};
%		\node [style=none] (2) at (11.5, 1.25) {};
%		\node [style=none] (3) at (12, 2.75) {};
%		\node [style=Z] (4) at (12.5, 1.25) {};
%		\node [style=none] (5) at (13, 0.5) {};
%		\node [style=none] (6) at (12, 0.5) {};
%		\node [style=none] (7) at (11.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-30] (0) to (1.center);
%		\draw (3.center) to (0);
%		\draw [in=90, out=-150] (0) to (2.center);
%		\draw [in=90, out=-30] (4) to (5.center);
%		\draw [in=90, out=-150] (4) to (6.center);
%		\draw (7.center) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture} , \hspace*{.2cm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (21) at (3.75, -0.75) {};
%		\node [style=none] (22) at (4.25, 0) {};
%		\node [style=none] (23) at (3.75, -1.5) {};
%		\node [style=none] (24) at (3.25, 0) {};
%		\node [style=none] (28) at (3.25, 0.75) {};
%		\node [style=none] (29) at (4.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (23.center) to (21);
%		\draw [in=-90, out=30] (21) to (22.center);
%		\draw [in=150, out=-90] (24.center) to (21);
%		\draw [in=270, out=90] (22.center) to (28.center);
%		\draw [in=270, out=90] (24.center) to (29.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\erefop{comm}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (30) at (5.75, -0.75) {};
%		\node [style=none] (31) at (6.25, 0) {};
%		\node [style=none] (32) at (5.75, -1.5) {};
%		\node [style=none] (33) at (5.25, 0) {};
%		\node [style=none] (34) at (6.25, 0.75) {};
%		\node [style=none] (35) at (5.25, 0.75) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (32.center) to (30);
%		\draw [in=-90, out=30] (30) to (31.center);
%		\draw [in=150, out=-90] (33.center) to (30);
%		\draw [in=270, out=90] (31.center) to (34.center);
%		\draw [in=270, out=90] (33.center) to (35.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%Compatible with the monoidal structure:
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0, 2.5) {};
%		\node [style=none] (1) at (1, 2.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%		\draw [style=simple, in=-90, out=117] (2) to (0.center);
%		\draw [style=simple, in=63, out=-90] (1.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 2.5) {};
%		\node [style=Z] (1) at (1, 2.5) {};
%		\node [style=none] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%		\node [style=none] (4) at (0, 3.5) {};
%		\node [style=none] (5) at (1, 3.5) {};
%		\node [style=none] (6) at (0, 4.5) {};
%		\node [style=none] (7) at (1, 4.5) {};
%		\node [style=otimes] (8) at (0.5, 1.5) {};
%		\node [style=otimes] (9) at (1, 3.5) {};
%		\node [style=otimes] (10) at (0, 3.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2.center);
%		\draw [style=simple, in=-90, out=135] (2.center) to (0);
%		\draw [style=simple] (0) to (5.center);
%		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
%		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
%		\draw [style=simple] (1) to (4.center);
%		\draw [style=simple, in=45, out=-90] (1) to (2.center);
%		\draw [style=simple] (4.center) to (6.center);
%		\draw [style=simple] (5.center) to (7.center);
%	\end{pgfonlayer}
%\end{tikzpicture}\ ,
%\hspace*{.2cm}
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (0) at (0, 2.5) {};
%		\node [style=none] (1) at (1, 2.5) {};
%		\node [style=Z] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2);
%		\draw [style=simple, in=-90, out=117] (2) to (0.center);
%		\draw [style=simple, in=63, out=-90] (1.center) to (2);
%	\end{pgfonlayer}
%\end{tikzpicture}
%=
%\begin{tikzpicture}[yscale=-1]
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 2.5) {};
%		\node [style=Z] (1) at (1, 2.5) {};
%		\node [style=none] (2) at (0.5, 1.5) {};
%		\node [style=none] (3) at (0.5, 0.5) {};
%		\node [style=none] (4) at (0, 3.5) {};
%		\node [style=none] (5) at (1, 3.5) {};
%		\node [style=none] (6) at (0, 4.5) {};
%		\node [style=none] (7) at (1, 4.5) {};
%		\node [style=otimes] (8) at (0.5, 1.5) {};
%		\node [style=otimes] (9) at (1, 3.5) {};
%		\node [style=otimes] (10) at (0, 3.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [style=simple] (3.center) to (2.center);
%		\draw [style=simple, in=-90, out=135] (2.center) to (0);
%		\draw [style=simple] (0) to (5.center);
%		\draw [style=simple, in=120, out=-120, looseness=1.25] (4.center) to (0);
%		\draw [style=simple, in=-60, out=60, looseness=1.25] (1) to (5.center);
%		\draw [style=simple] (1) to (4.center);
%		\draw [style=simple, in=45, out=-90] (1) to (2.center);
%		\draw [style=simple] (4.center) to (6.center);
%		\draw [style=simple] (5.center) to (7.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%Where the comonoid and monoid are natural so that 
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (12) at (2, 0) {};
		\node [style=none] (15) at (2.5, 0.75) {};
		\node [style=none] (17) at (2, -0.75) {};
		\node [style=none] (18) at (1.5, 0.75) {};
		\node [style=map] (19) at (2, -0.75) {$f$};
		\node [style=none] (20) at (2, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (17.center) to (12);
		\draw [in=-90, out=30] (12) to (15.center);
		\draw [in=150, out=-90] (18.center) to (12);
		\draw (20.center) to (17.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (21) at (3.75, -0.75) {};
		\node [style=none] (22) at (4.25, 0) {};
		\node [style=none] (23) at (3.75, -1.5) {};
		\node [style=none] (24) at (3.25, 0) {};
		\node [style=map] (25) at (3.25, 0) {$f$};
		\node [style=map] (27) at (4.25, 0) {$f$};
		\node [style=none] (28) at (3.25, 0.75) {};
		\node [style=none] (29) at (4.25, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (23.center) to (21);
		\draw [in=-90, out=30] (21) to (22.center);
		\draw [in=150, out=-90] (24.center) to (21);
		\draw (28.center) to (25);
		\draw (29.center) to (27);
	\end{pgfonlayer}
\end{tikzpicture}
\ ,
\hspace*{.2cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (30) at (5.75, -0.75) {};
		\node [style=none] (31) at (6.25, -1.5) {};
		\node [style=none] (32) at (5.75, 0) {};
		\node [style=none] (33) at (5.25, -1.5) {};
		\node [style=map] (34) at (5.75, 0) {$f$};
		\node [style=none] (35) at (5.75, 0.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (32.center) to (30);
		\draw [in=90, out=-30] (30) to (31.center);
		\draw [in=-150, out=90] (33.center) to (30);
		\draw (35.center) to (32.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (36) at (7.5, 0) {};
		\node [style=none] (37) at (8, -0.75) {};
		\node [style=none] (38) at (7.5, 0.75) {};
		\node [style=none] (39) at (7, -0.75) {};
		\node [style=map] (40) at (7, -0.75) {$f$};
		\node [style=map] (41) at (8, -0.75) {$f$};
		\node [style=none] (42) at (7, -1.5) {};
		\node [style=none] (43) at (8, -1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (38.center) to (36);
		\draw [in=90, out=-30] (36) to (37.center);
		\draw [in=-150, out=90] (39.center) to (36);
		\draw (42.center) to (40);
		\draw (43.center) to (41);
	\end{pgfonlayer}
\end{tikzpicture}
$$
%
%Where the commutative semigroup and cocommutative cosemigroup  interact to form a $\dag$-semi-Frobenius algebra:
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0.75, 0.5) {};
%		\node [style=Z] (1) at (0, 1) {};
%		\node [style=none] (2) at (0, 1.5) {};
%		\node [style=none] (6) at (1, 1.5) {};
%		\node [style=none] (7) at (-0.25, 0) {};
%		\node [style=none] (8) at (0.75, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (1) to (2.center);
%		\draw [in=90, out=-120] (1) to (7.center);
%		\draw (0) to (1);
%		\draw [in=-90, out=60] (0) to (6.center);
%		\draw (8.center) to (0);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{frobl}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (98) at (50.75, 0) {};
%		\node [style=none] (99) at (51.75, 0) {};
%		\node [style=Z] (101) at (51.25, 0.5) {};
%		\node [style=none] (102) at (50.75, 1.5) {};
%		\node [style=none] (103) at (51.75, 1.5) {};
%		\node [style=Z] (104) at (51.25, 1) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw [in=90, out=-165, looseness=0.75] (101) to (98.center);
%		\draw [in=-15, out=90, looseness=0.75] (99.center) to (101);
%		\draw [in=-90, out=165, looseness=0.75] (104) to (102.center);
%		\draw [in=15, out=-90, looseness=0.75] (103.center) to (104);
%		\draw (101) to (104);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{frobr}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (17) at (4.5, 0.5) {};
%		\node [style=Z] (18) at (5.25, 1) {};
%		\node [style=none] (19) at (5.25, 1.5) {};
%		\node [style=none] (20) at (4.25, 1.5) {};
%		\node [style=none] (21) at (5.5, 0) {};
%		\node [style=none] (22) at (4.5, 0) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (18) to (19.center);
%		\draw [in=90, out=-60] (18) to (21.center);
%		\draw (17) to (18);
%		\draw [in=-90, out=120] (17) to (20.center);
%		\draw (22.center) to (17);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
%
%Which is also special:
%
%$$
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=Z] (0) at (0, 0) {};
%		\node [style=Z] (1) at (0, 1) {};
%		\node [style=none] (2) at (0, 1.5) {};
%		\node [style=none] (3) at (0, -0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (0) to (3.center);
%		\draw [bend left=45, looseness=1.25] (0) to (1);
%		\draw [bend left=45, looseness=1.25] (1) to (0);
%		\draw (1) to (2.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%\eref{special}
%\begin{tikzpicture}
%	\begin{pgfonlayer}{nodelayer}
%		\node [style=none] (6) at (1, 1.5) {};
%		\node [style=none] (7) at (1, -0.5) {};
%	\end{pgfonlayer}
%	\begin{pgfonlayer}{edgelayer}
%		\draw (7.center) to (6.center);
%	\end{pgfonlayer}
%\end{tikzpicture}
%$$
\end{definition}

Discrete inverse categories are inverse categories with respect to the dagger. 

\begin{lemma}[{\cite[Lemma 4.3.5]{giles}}]
The restriction idempotents are strengths for the multiplication and comultiplication so that:
$$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 2) {};
		\node [style=none] (1) at (3, 1.5) {};
		\node [style=none] (2) at (2.5, 3) {};
		\node [style=none] (3) at (3.5, 3) {};
		\node [style=map] (4) at (2.5, 3) {$\bar f$};
		\node [style=none] (5) at (3.5, 3.5) {};
		\node [style=none] (6) at (2.5, 3.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=63, out=-90] (3.center) to (0);
		\draw [style=simple, in=-90, out=117] (0) to (2.center);
		\draw [style=simple] (6.center) to (2.center);
		\draw [style=simple] (5.center) to (3.center);
		\draw [style=simple] (0) to (1.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eqzxa{phasel}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 1.75) {};
		\node [style=map] (1) at (3, 1) {$\bar f$};
		\node [style=none] (2) at (3, 0.5) {};
		\node [style=none] (3) at (2.5, 2.5) {};
		\node [style=none] (4) at (3.5, 2.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=63, out=-90] (4.center) to (0);
		\draw [style=simple, in=-90, out=117] (0) to (3.center);
		\draw [style=simple] (1) to (0);
		\draw [style=simple] (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\eqzxa{phaser}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 2) {};
		\node [style=none] (1) at (3, 1.5) {};
		\node [style=none] (2) at (3.5, 3) {};
		\node [style=none] (3) at (2.5, 3) {};
		\node [style=map] (4) at (3.5, 3) {$\bar f$};
		\node [style=none] (5) at (2.5, 3.5) {};
		\node [style=none] (6) at (3.5, 3.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=117, out=-90] (3.center) to (0);
		\draw [style=simple, in=-90, out=63] (0) to (2.center);
		\draw [style=simple] (6.center) to (2.center);
		\draw [style=simple] (5.center) to (3.center);
		\draw [style=simple] (0) to (1.center);
	\end{pgfonlayer}
\end{tikzpicture}
\hspace*{.6cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 3) {};
		\node [style=none] (1) at (3, 3.5) {};
		\node [style=none] (2) at (2.5, 2) {};
		\node [style=none] (3) at (3.5, 2) {};
		\node [style=map] (4) at (2.5, 2) {$\bar f$};
		\node [style=none] (5) at (3.5, 1.5) {};
		\node [style=none] (6) at (2.5, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-63, out=90] (3.center) to (0);
		\draw [style=simple, in=90, out=-117] (0) to (2.center);
		\draw [style=simple] (6.center) to (2.center);
		\draw [style=simple] (5.center) to (3.center);
		\draw [style=simple] (0) to (1.center);
	\end{pgfonlayer}
\end{tikzpicture}
\erefop{phasel}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 1.25) {};
		\node [style=map] (1) at (3, 2) {$\bar f$};
		\node [style=none] (2) at (3, 2.5) {};
		\node [style=none] (3) at (2.5, 0.5) {};
		\node [style=none] (4) at (3.5, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-63, out=90] (4.center) to (0);
		\draw [style=simple, in=90, out=-117] (0) to (3.center);
		\draw [style=simple] (1) to (0);
		\draw [style=simple] (1) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\erefop{phaser}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=Z] (0) at (3, 3) {};
		\node [style=none] (1) at (3, 3.5) {};
		\node [style=none] (2) at (3.5, 2) {};
		\node [style=none] (3) at (2.5, 2) {};
		\node [style=map] (4) at (3.5, 2) {$\bar f$};
		\node [style=none] (5) at (2.5, 1.5) {};
		\node [style=none] (6) at (3.5, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=-117, out=90] (3.center) to (0);
		\draw [style=simple, in=90, out=-63] (0) to (2.center);
		\draw [style=simple] (6.center) to (2.center);
		\draw [style=simple] (5.center) to (3.center);
		\draw [style=simple] (0) to (1.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
\end{lemma}
\begin{lemma}
\label{def:pariso}
Given a finitely complete category $\X$, the category  $\ParIso(\X):=\Inv(\Par(\X))$ of spans of monomorphisms in $\X$ is a discrete inverse category.
\end{lemma}
These weaken the notion of copying even further:
\begin{lemma}[{\cite[Proposition 4.3.7]{giles}}]
Given a discrete Cartesian restriction category $\X$, $\Inv(\X)$ is a discrete inverse category.
\end{lemma}
At least as far as the literature is concerned, the canonical way to obtain a discrete Cartesian restriction category from a discrete category is more difficult.  We will first introduce the more CoPara construction, which freely adds an effect to every object in a way that is compatible with the tensor product:
\begin{definition}
Given a symmetric monoidal category $\X$, the CoPara construction, $\CoPara(\X)$ is the symmetric monoidal category obtained by freely adding maps $X\to I$ for every object $X$, compatible with the tensor unit:
\begin{description}
\item[Objects:] Same as in $\X$.
\item[Maps:]  
\hfil $
\dfrac{ X\xrightarrow{f}  S\otimes Y \in \X           }
         { X\xrightarrow{(f,S)} Y \in  \CoPara(\X) }
$
\item[Composition:]
\hfil $
\dfrac{
	X\xrightarrow{(f,S)} Y , \hspace*{.5cm} Y\xrightarrow{(g,T)} Z }
         {X\xrightarrow{
		(f,S);(g;T) := (f;(1_S \otimes g);\alpha^{-1}_{S,T,Z} ,S\otimes T)}Z} 
$


\hfil Or in string diagrams:
\hspace*{.5cm}
$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$f$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
;
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$g$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (1, 1.5) {$f$};
		\node [style=none] (1) at (0.5, 2.5) {};
		\node [style=none] (2) at (1, 0.5) {};
		\node [style=map] (3) at (1.5, 2.5) {$g$};
		\node [style=none] (4) at (2, 3.5) {};
		\node [style=otimes] (5) at (1, 3.5) {};
		\node [style=none] (6) at (1.5, 2.5) {};
		\node [style=none] (7) at (2, 4.5) {};
		\node [style=none] (8) at (1, 4.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=-90, out=117] (0) to (1.center);
		\draw (0) to (2.center);
		\draw [in=63, out=-90] (4.center) to (3);
		\draw (3) to (5);
		\draw [in=63, out=-90] (6.center) to (0);
		\draw [in=-117, out=90] (1.center) to (5);
		\draw (5) to (8.center);
		\draw (4.center) to (7.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\item[Identity:]
$$
\dfrac{ 1_X \in  \CoPara(\X)}{(u^L_X)^{-1} \in \X}
$$
\hfil Or in string diagrams:
\hspace*{.5cm}
$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (1) at (12.25, -2.25) {};
		\node [style=none] (2) at (12.25, -1.25) {};
		\node [style=none] (3) at (11.25, -1.25) {};
		\node [style=none] (4) at (12.25, -2.5) {$X$};
		\node [style=unit] (7) at (11.25, -2) {};
		\node [style=none] (8) at (12.25, -1) {$X$};
		\node [style=none] (9) at (11.25, -1) {$I$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (2.center) to (1.center);
		\draw (7) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\item[Tensor product:]
$$
\dfrac{
	X\xrightarrow{(f,S)} Y\ , \hspace*{1cm} Z\xrightarrow{(g,T)} W }
{
	X\otimes Z 
		\xrightarrow{
		(f,S)\otimes (g;T) :=  
		(f\otimes g);
		\alpha_{S\otimes Y, T,W}^{-1};
		\alpha_{S,Y, T} \otimes 1_W;
		(1_S\otimes \sigma_{Y,T})\otimes 1_W;
		\alpha_{S,T,Y}^{-1}\otimes 1_W;
		\alpha_{S\otimes T,Y,W}}
	Y\otimes W
} 
$$
\hfil Or in string diagrams:
\hspace*{.5cm}
$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$f$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
\otimes
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$g$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (9) at (3.5, 1.5) {$f$};
		\node [style=map] (13) at (4.5, 1.5) {$g$};
		\node [style=otimes] (17) at (4.5, 2.5) {};
		\node [style=otimes] (18) at (3.5, 2.5) {};
		\node [style=otimes] (190) at (4, 0.75) {};
		\node  (19) at (4, 0.75) {};
		\node [style=none] (20) at (3.5, 3) {};
		\node [style=none] (21) at (4.5, 3) {};
		\node [style=none] (22) at (4, 0.25) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (13) to (18);
		\draw [bend right] (18) to (9);
		\draw (9) to (17);
		\draw [bend left] (17) to (13);
		\draw [in=45, out=-90] (13) to (19);
		\draw [in=-90, out=135] (19) to (9);
		\draw (21.center) to (17);
		\draw (22.center) to (19);
		\draw (18) to (20.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\item[Tensor unit:]\
$$
\dfrac{ I \in  \CoPara(\X)}{ 1_{I\otimes I}\in \X}
$$
\hfil Or in string diagrams:
\hspace*{.5cm}
$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (11.25, 2) {};
		\node [style=none] (1) at (12.25, 2) {};
		\node [style=none] (2) at (11.75, 1.25) {};
		\node [style=none] (3) at (11.75, 0.5) {};
		\node [style=none] (4) at (12.25, 2.25) {$I$};
		\node [style=none] (5) at (11.75, 0.25) {$I\otimes I$};
		\node [style=otimes] (6) at (11.75, 1.25) {};
		\node [style=none] (7) at (11.25, 2.25) {$I$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (3.center) to (2.center);
		\draw [in=-90, out=150] (2.center) to (0.center);
		\draw [in=-90, out=30] (2.center) to (1.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\end{description}
\end{definition}
The coherence data for the monoidal structure is inherited in a straightforward way from $\X$. Moreover, if $\X$ is symmetric monoidal, then it is easy to see how ${\CoPara}(\X)$ is as well.  In other words ${\CoPara}(\X)$ could have alternatively been presented  by  freely adding generators $d_X:X\to I$ to the monoidal theory of  the strictification of $\X$, for every object in $\X$ compatible with the monoidal structure.  In ${\CoPara}(\X)$ the map $d_X$ corresponds to the inverse left unitor $(u_X^L)^{-1}$:
$$
d_X:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (52) at (61.75, -2.25) {};
		\node [style=none] (53) at (61.75, -1.25) {};
		\node [style=none] (54) at (62.75, -1.25) {};
		\node [style=none] (55) at (61.75, -2.5) {$X$};
		\node [style=unit] (56) at (62.75, -2) {};
		\node [style=none] (57) at (61.75, -1) {$X$};
		\node [style=none] (58) at (62.75, -1) {$I$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (53.center) to (52.center);
		\draw (56) to (54.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
Variations on this theme will occur throughout this thesis, so we have promoted it to its own construction.  For reference, the CoPara construction is dual to the Para construction which is interpreted as freely adding parameters to  a monoidal category (see \cite{Fong2019backprop}).
This allows us to define the following:
\begin{definition}\cite[Definition 5.1.1]{giles}
Given a discrete inverse category $\X$,  its {\bf Cartesian completion} $\tilde \X$ is the quotient of ${\CoPara}(\X)$ by either of the following equivalent symmetric monoidal congruence relations:
$$
(f,S)\sim(g,T) \iff
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0.75, 1.5) {$f$};
		\node [style=none] (1) at (0.75, 0.5) {};
		\node [style=map] (2) at (0.75, 3) {$f^\circ$};
		\node [style=map] (3) at (0.75, 4) {$g$};
		\node [style=Z] (4) at (1.25, 2.25) {};
		\node [style=Z] (5) at (1.25, 5) {};
		\node [style=none] (6) at (1.25, 6) {};
		\node [style=none] (7) at (0.5, 6) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (1.center);
		\draw [in=105, out=-90] (7.center) to (3);
		\draw (6.center) to (5);
		\draw [in=60, out=-60] (5) to (4);
		\draw (4) to (2);
		\draw [in=120, out=-120, looseness=1.25] (2) to (0);
		\draw (0) to (4);
		\draw (3) to (2);
		\draw (3) to (5);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$g$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
\hspace*{.3cm}
or
\hspace*{.3cm}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0.75, 1.5) {$g$};
		\node [style=none] (1) at (0.75, 0.5) {};
		\node [style=map] (2) at (0.75, 3) {$g^\circ$};
		\node [style=map] (3) at (0.75, 4) {$f$};
		\node [style=Z] (4) at (1.25, 2.25) {};
		\node [style=Z] (5) at (1.25, 5) {};
		\node [style=none] (6) at (1.25, 6) {};
		\node [style=none] (7) at (0.5, 6) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (0) to (1.center);
		\draw [in=105, out=-90] (7.center) to (3);
		\draw (6.center) to (5);
		\draw [in=60, out=-60] (5) to (4);
		\draw (4) to (2);
		\draw [in=120, out=-120, looseness=1.25] (2) to (0);
		\draw (0) to (4);
		\draw (3) to (2);
		\draw (3) to (5);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (0, 1.5) {$f$};
		\node [style=none] (1) at (-0.5, 2.5) {};
		\node [style=none] (2) at (0.5, 2.5) {};
		\node [style=none] (3) at (0, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [in=117, out=-90] (1.center) to (0);
		\draw [in=-90, out=63] (0) to (2.center);
		\draw (0) to (3.center);
	\end{pgfonlayer}
\end{tikzpicture}
$$
$\tilde \X$ has the structure of a discrete Cartesian restriction category with:
\begin{description}
\item[Restriction product:]
\hfil
$
\langle f,g \rangle:=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (-0.25, 2.5) {$f$};
		\node [style=none] (1) at (-0.25, 3.5) {};
		\node [style=none] (2) at (0.75, 3.5) {};
		\node [style=none] (3) at (-0.25, 3.5) {};
		\node [style=map] (4) at (0.75, 2.5) {$g$};
		\node [style=none] (5) at (0.75, 3.5) {};
		\node [style=otimes] (6) at (0.75, 3.5) {};
		\node [style=otimes] (7) at (-0.25, 3.5) {};
		\node [style=Z] (8) at (0.25, 1.5) {};
		\node [style=none] (9) at (-0.25, 4.5) {};
		\node [style=none] (10) at (0.75, 4.5) {};
		\node [style=none] (11) at (0.25, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw [style=simple, in=117, out=-120] (1.center) to (0);
		\draw [style=simple] (2.center) to (0);
		\draw [style=simple] (3.center) to (4);
		\draw [style=simple, in=63, out=-60] (5.center) to (4);
		\draw [style=simple, in=56, out=-90] (4) to (8);
		\draw [style=simple, in=-90, out=124] (8) to (0);
		\draw [style=simple] (9.center) to (1.center);
		\draw [style=simple] (2.center) to (10.center);
		\draw [style=simple] (8) to (11.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\item[Restriction terminal map:]
\hfil
$
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (0) at (12.75, -0.25) {};
		\node [style=none] (1) at (12.75, -1.25) {};
		\node [style=none] (2) at (12.75, 0) {$X$};
		\node [style=none] (3) at (12.75, -1.5) {$X$};
		\node [style=none] (4) at (11.75, -0.75) {};
		\node [style=unit] (5) at (11.75, -0.75) {};
		\node [style=none] (6) at (11.75, -0.25) {};
		\node [style=none] (7) at (11.75, 0) {$I$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1.center) to (0.center);
		\draw (4.center) to (6.center);
	\end{pgfonlayer}
\end{tikzpicture}
$
\end{description}
\end{definition}
We give a simpler characterization of this construction terms of adding counits to the inverse products in Proposition \ref{cor:copy}.
\begin{theorem}[{\cite[Theorem 5.2.6]{giles}}]
There is an equivalence of categories between the category of discrete inverse categories and the category of discrete Cartesian categories.
%Therefore, given a discrete inverse category $\X$
%$\Inv(\tilde \X)\cong \X$.
\end{theorem}
 This equivalence is witnessed on the one hand by the Cartesian completion and on the other by taking the wide subcategory of partial isomorphisms.  As a corollary, we see that 
\begin{example}[{\cite[Example 5.3.3]{giles}}]
$\tilde \Pinj$ is $\Par$.
\end{example}

\begin{proof}
For a partial function $f:X\to Y$, $\{(x,(x,y)) | (x,y) \in f \}/\sim$ is a partial isomorphism.
\end{proof}
The Cartesian completion is itself an embedding:
\begin{lemma}
\label{lemma:xtildefaithful}
The canonical functor $\iota:\X\to \tilde \X$ is faithful.
\end{lemma}
\begin{proof}
Suppose that $\iota(f)\sim\iota(g)$, Then:
\begin{align*}
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (0) at (17.25, 1.5) {$g$};
		\node [style=none] (1) at (17.25, 2.5) {};
		\node [style=none] (2) at (17.25, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (1.center) to (0);
		\draw (0) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
&=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (3) at (16.25, 1.25) {$f$};
		\node [style=none] (4) at (16.25, 0.5) {};
		\node [style=map] (5) at (16, 3) {$f^\circ$};
		\node [style=map] (6) at (16, 3.75) {$g$};
		\node [style=Z] (7) at (16.25, 2) {};
		\node [style=Z] (8) at (16.25, 4.75) {};
		\node [style=none] (9) at (16.25, 5.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (3) to (4.center);
		\draw (9.center) to (8);
		\draw [in=60, out=-60, looseness=0.75] (8) to (7);
		\draw [in=-90, out=124] (7) to (5);
		\draw (3) to (7);
		\draw (6) to (5);
		\draw [in=-117, out=90] (6) to (8);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (10) at (15, 0.5) {};
		\node [style=map] (11) at (14.75, 4.5) {$g$};
		\node [style=Z] (12) at (15, 2.75) {};
		\node [style=Z] (13) at (15, 5.5) {};
		\node [style=none] (14) at (15, 6.5) {};
		\node [style=map] (15) at (14.75, 3.75) {$f^\circ$};
		\node [style=map] (16) at (15, 1.25) {$f$};
		\node [style=map] (17) at (15, 2) {$f^\circ f$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (14.center) to (13);
		\draw [in=60, out=-60, looseness=0.75] (13) to (12);
		\draw [in=-117, out=90] (11) to (13);
		\draw [in=-90, out=124] (12) to (15);
		\draw (11) to (15);
		\draw [style=simple] (12) to (17);
		\draw [style=simple] (17) to (16);
		\draw [style=simple] (16) to (10.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (18) at (13.25, 0.5) {};
		\node [style=map] (19) at (12.75, 4) {$g$};
		\node [style=Z] (20) at (13.25, 2.25) {};
		\node [style=Z] (21) at (13.25, 5) {};
		\node [style=none] (22) at (13.25, 6) {};
		\node [style=map] (23) at (12.75, 3.25) {$f^\circ$};
		\node [style=map] (24) at (13.25, 1.25) {$f$};
		\node [style=map] (25) at (13.75, 3.25) {$f^\circ f$};
		\node [style=none] (26) at (13.75, 4) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (22.center) to (21);
		\draw [in=-120, out=90] (19) to (21);
		\draw [in=-90, out=124] (20) to (23);
		\draw (19) to (23);
		\draw [style=simple] (24) to (18.center);
		\draw [style=simple, in=-90, out=60] (20) to (25);
		\draw [style=simple] (20) to (24);
		\draw [style=simple, in=90, out=-60] (21) to (26.center);
		\draw [style=simple] (26.center) to (25);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (27) at (11.25, 0.5) {};
		\node [style=map] (28) at (10.75, 3.25) {$g$};
		\node [style=Z] (29) at (11.25, 2.25) {};
		\node [style=Z] (30) at (11.25, 4.25) {};
		\node [style=none] (31) at (11.25, 5.25) {};
		\node [style=map] (32) at (11.25, 1.25) {$ff^\circ$};
		\node [style=map] (33) at (11.75, 3.25) {$f$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (31.center) to (30);
		\draw [in=-120, out=90] (28) to (30);
		\draw [style=simple] (32) to (27.center);
		\draw [style=simple, in=-90, out=60] (29) to (33);
		\draw [style=simple] (29) to (32);
		\draw [style=simple, in=120, out=-90] (28) to (29);
		\draw [style=simple, in=90, out=-60] (30) to (33);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (34) at (9.25, 0.5) {};
		\node [style=map] (35) at (8.75, 3.25) {$g$};
		\node [style=Z] (36) at (9.25, 1.5) {};
		\node [style=Z] (37) at (9.25, 4.25) {};
		\node [style=none] (38) at (9.25, 5.25) {};
		\node [style=map] (39) at (9.75, 3.25) {$f$};
		\node [style=map] (40) at (9.75, 2.5) {$ff^\circ$};
		\node [style=none] (41) at (8.75, 2.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (38.center) to (37);
		\draw [in=-120, out=90] (35) to (37);
		\draw [style=simple, in=90, out=-60] (37) to (39);
		\draw (35) to (41.center);
		\draw [in=120, out=-90] (41.center) to (36);
		\draw (36) to (34.center);
		\draw [in=-90, out=60] (36) to (40);
		\draw (40) to (39);
	\end{pgfonlayer}
\end{tikzpicture}\\
&=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (42) at (7.25, 0.5) {};
		\node [style=map] (43) at (6.75, 2.5) {$g$};
		\node [style=Z] (44) at (7.25, 1.5) {};
		\node [style=Z] (45) at (7.25, 3.5) {};
		\node [style=none] (46) at (7.25, 4.5) {};
		\node [style=map] (47) at (7.75, 2.5) {$f$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (46.center) to (45);
		\draw [in=-120, out=90] (43) to (45);
		\draw [style=simple, in=90, out=-60] (45) to (47);
		\draw (44) to (42.center);
		\draw [in=120, out=-90] (43) to (44);
		\draw [in=-90, out=60] (44) to (47);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (48) at (5.25, 0.5) {};
		\node [style=Z] (49) at (5.25, 1) {};
		\node [style=Z] (50) at (5.25, 4) {};
		\node [style=none] (51) at (5.25, 4.5) {};
		\node [style=map] (52) at (4.75, 2.5) {$g$};
		\node [style=map] (53) at (5.75, 2.5) {$f$};
		\node [style=none] (54) at (5.75, 3.5) {};
		\node [style=none] (55) at (4.75, 3.5) {};
		\node [style=none] (56) at (5.75, 1.5) {};
		\node [style=none] (57) at (4.75, 1.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (51.center) to (50);
		\draw (49) to (48.center);
		\draw [in=90, out=-90] (54.center) to (52);
		\draw [in=90, out=-90] (52) to (56.center);
		\draw [in=-90, out=90] (57.center) to (53);
		\draw [in=-90, out=90] (53) to (55.center);
		\draw [in=-165, out=90] (55.center) to (50);
		\draw [in=90, out=-15] (50) to (54.center);
		\draw [in=15, out=-90] (56.center) to (49);
		\draw [in=-90, out=165] (49) to (57.center);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=none] (58) at (3.25, 0.5) {};
		\node [style=map] (59) at (2.75, 2.5) {$f$};
		\node [style=Z] (60) at (3.25, 1.5) {};
		\node [style=Z] (61) at (3.25, 3.5) {};
		\node [style=none] (62) at (3.25, 4.5) {};
		\node [style=map] (63) at (3.75, 2.5) {$g$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (62.center) to (61);
		\draw [in=-120, out=90] (59) to (61);
		\draw [style=simple, in=90, out=-60] (61) to (63);
		\draw (60) to (58.center);
		\draw [in=120, out=-90] (59) to (60);
		\draw [in=-90, out=60] (60) to (63);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (64) at (1.75, 1.25) {$g$};
		\node [style=none] (65) at (1.75, 0.5) {};
		\node [style=map] (66) at (1.5, 3) {$g^\circ$};
		\node [style=map] (67) at (1.5, 3.75) {$f$};
		\node [style=Z] (68) at (1.75, 2) {};
		\node [style=Z] (69) at (1.75, 4.75) {};
		\node [style=none] (70) at (1.75, 5.75) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (64) to (65.center);
		\draw (70.center) to (69);
		\draw [in=60, out=-60, looseness=0.75] (69) to (68);
		\draw [in=-90, out=124] (68) to (66);
		\draw (64) to (68);
		\draw (67) to (66);
		\draw [in=-117, out=90] (67) to (69);
	\end{pgfonlayer}
\end{tikzpicture}
=
\begin{tikzpicture}
	\begin{pgfonlayer}{nodelayer}
		\node [style=map] (71) at (0.5, 1.5) {$f$};
		\node [style=none] (72) at (0.5, 2.5) {};
		\node [style=none] (73) at (0.5, 0.5) {};
	\end{pgfonlayer}
	\begin{pgfonlayer}{edgelayer}
		\draw (72.center) to (71);
		\draw (71) to (73.center);
	\end{pgfonlayer}
\end{tikzpicture}
\end{align*}
\end{proof}
Obtaining Cartesian bicategories of relations from discrete inverse categories is more difficult.  We will discuss this later in the thesis.
Let us summarize the various notions of weakenings of Cartesian bicategories of relations in a table:

%TODO https://arxiv.org/pdf/0708.1925.pdf

\hfil
\begin{tabular}{l|cccc}
                                                     & $\Delta$          & $!$             & $\Delta^*$         & $!^*$\\
\hline
Discrete inverse category            & nat &  & nat  & \\
Discrete Cartesian restriction category      & nat &  lax  & lax \\
Cartesian category                                      & nat & nat &   \\
Cartesian bicategory of relations & lax  & lax & lax & lax \\
\end{tabular}
